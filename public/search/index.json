[{"content":"åˆšçœ‹å®Œå¿ƒé‡Œçš„é‚£ç§ä¸åä¸å¿«çš„æƒ³æ³•ï¼Œä¾¿æ²¹ç„¶è€Œç”Ÿäº†ï¼Œè€Œä¸”å¸¦ç€ä¸€äº›è¯´ä¸æ¸…çš„æ¿€åŠ¨å…´å¥‹ï¼Œæƒ³æŠŠè®°å¿†ä¹¦é¢åŒ–ã€‚\nå°è¯´æ€»å…±34.5ä¸‡å­—ï¼Œå¤§æ¦‚èŠ±äº†ä¸€ä¸ªå‘¨æœ«å°å¿ƒç¿¼ç¿¼åœ°ç²—è¯»å®Œï¼Œè¯»å®Œçš„é‚£ä¸€åˆ»æœ‰ä¸€ç‚¹ä¸èˆçš„æƒ…ç»ªã€‚ç®€çˆ±è¿™ä¸ªäººç‰©ä»¿ä½›ä½åœ¨æˆ‘å¿ƒé‡Œï¼Œéå¸¸é’¦ä½©å¥¹çš„ç‹¬ç«‹è‡ªå°Šè‡ªçˆ±çš„äººæ ¼ï¼Œè¢«å…¶æ·±æ·±åœ°å¸å¼•ã€‚çœ‹åˆ°ç»“å±€æœ€åç®€çˆ±åšå®šé€‰æ‹©äº†å¯¹çˆ±æƒ…çš„è¿½æ±‚ï¼Œå¿ƒé‡Œæœ‰ä¸€äº›æ„ŸåŠ¨ã€‚ä»å¼€ç«¯åˆ°ç»“å±€ï¼Œè¿‡ç¨‹æ¯”è¾ƒæ›²æŠ˜ï¼Œå› ä¸ºç®€çˆ±çš„äººæ ¼æœ€ç»ˆæ˜¯å–œå‰§æ€§æ”¶å°¾ã€‚\nä»”ç»†å›æƒ³èµ·æ¥ï¼Œå°è¯´æ•´ä½“æ–‡å­—è¡¨è¾¾éå¸¸ç»†è…»ï¼Œç‰¹åˆ«æ˜¯äººç‰©å¯¹è¯è¡¨ç°å¾—å«è“„ä¼˜é›…ã€‚æœ‰å‡ ä¸ªåœ°æ–¹å°è±¡é¢‡ä¸ºæ·±åˆ»ï¼Œæƒ³è®°å½•ä¸‹æ¥ã€‚\nç«¥å¹´æ—¶å€™çš„ç®€çˆ±åœ¨å­¦æ ¡è®¤è¯†çš„å”¯ä¸€è¦å¥½çš„æœ‹å‹æµ·ä¼¦å› ä¸ºæŸ“ç—…å³å°†æ­»å»çš„é‚£æ®µå¯¹ç™½ï¼Œåœ¨åŠ¨ä½œã€å¯¹è¯ã€å¿ƒç†æå†™ä¸Šéƒ½éå¸¸æœ‰æ„ŸæŸ“åŠ›ï¼Œç°åœ¨æƒ³èµ·æ¥éƒ½è§‰å¾—æœ‰äº›å“½å’½ã€‚ç®€çˆ±ä¹‹æ‰€ä»¥æ¥åˆ°è¿™æ‰€ç¯å¢ƒæ¶åŠ£çš„å­¦æ ¡ï¼Œåœ¨åé¢ä¹Ÿæœ‰äº¤ä»£æ¸…æ¥šï¼ŒåŸæ¥èˆ…å¦ˆå‡ºäºè‡ªå·±çš„å«‰å¦’ä»‡æ¨å¿ƒç†ï¼Œè®©ç«¥å¹´çš„ç®€çˆ±è’™å—äº†å¾ˆå¤šå§”å±ˆåˆ›ä¼¤ã€‚æœ€ååœ¨èˆ…å¦ˆä¸´ç»ˆå‰ä¹Ÿå¾—åˆ°äº†ç®€çˆ±çš„åŸè°…é‡Šç„¶ï¼Œç®€çˆ±ç†è§£äº†ä¸ºä»€ä¹ˆèˆ…å¦ˆå½“åˆé‚£æ ·å¯¹å¥¹ã€‚ç®€çˆ±ä»å°çš„è¿™äº›ç”Ÿæ´»ç»å†ï¼Œé”»ç‚¼å¼ºåŒ–äº†å¥¹çš„äººæ ¼ï¼Œå¥¹æ²¡æœ‰é€‰æ‹©å¦¥åï¼Œè¿™ä¹Ÿæ˜¯ä½œè€…æƒ³å¼ºè°ƒçš„å§ã€‚ç®€çˆ±åœ¨ç”·ä¸»äººå…¬å®¶é‡Œæ‹…ä»»å®¶åº­æ•™å¸ˆï¼Œç½—åˆ‡æ–¯ç‰¹å› ä¸ºå¥¹çš„äººæ ¼å’Œæ‰åæ·±æ·±åœ°çˆ±ä¸Šäº†å¥¹ï¼Œå½“æ—¶çœ‹åˆ°è¿™é‡Œå¥½æƒ³å°±è¿™æ ·å½¼æ­¤å¹¸ç¦ä¸‹å»ï¼Œå¯æ˜¯åè½¬å‡ºç°äº†ï¼Œç½—åˆ‡æ–¯ç‰¹çš„å®¶é‡Œè—ç€æ‚£æœ‰ç²¾ç¥ç—…çš„å¦»å­ï¼Œè¿™ä¸ªäº‹æƒ…ä¸€ç›´éšç’åœ¨ç»“å©šé‚£å¤©ï¼Œå³ä¾¿ç›¸äº’æ·±çˆ±ï¼Œä½†å› ä¸ºäººæ ¼ä¸‰è§‚ç­‰å› ç´ ï¼Œç®€çˆ±ç¦»å¼€äº†ï¼Œå“ªæ€•åé¢è‹¦éš¾ç­‰å¾…ç€å¥¹ã€‚\nåé¢çš„å‰§æƒ…æœ‰äº›æˆå‰§æ€§ï¼Œç®€çˆ±é™©äº›åœ¨è‹¦éš¾ä¸­æ­»å»ï¼Œæ²¡æƒ³åˆ°æœ€åæ˜¯è¡¨å“¥çº¦ç¿°æ•‘äº†å¥¹ï¼Œä¸è¿‡è¿™ä¸ªæ˜¯åé¢æ‰åè½¬äº¤ä»£ã€‚ç®€çˆ±çš„é«˜å°šäººæ ¼åœ¨ä¹¡æ‘æ•™å­¦ä½“ç°å¾—æ¯”è¾ƒæ˜æ˜¾ï¼Œåœ¨æ„å¤–å¾—åˆ°ä¸€ç¬”ä¸è²çš„è´¢å¯Œä¹Ÿè¦å¹³åˆ†çš„æƒ…èŠ‚äº¦å¦‚æ­¤ã€‚çº¦ç¿°çš„çŒ®æ®·å‹¤æœä¸å…¶ç„¶è¯å®äº†æ˜¯å–œæ¬¢ä¸Šäº†ç®€çˆ±ï¼Œä½†è¿™ç§çˆ±æƒ…æ˜¯å‡ºäºè‡ªæˆ‘æ„æ„¿ï¼Œè€Œéå‡ºäºåƒç½—åˆ‡æ–¯ç‰¹é‚£æ ·çš„çœŸæŒšçˆ±æƒ…ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œçº¦ç¿°è¿™ä¸ªäººç‰©æ›´åƒæ˜¯ä»£è¡¨äº†å¯¹ç†æƒ³çš„æ‰§ç€è¿½æ±‚ã€‚ç®€çˆ±è‡ªå°Šè‡ªçˆ±ï¼Œå¾ˆæ¸…æ™°çŸ¥é“è‡ªå·±æƒ³è¦çš„æ˜¯ä»€ä¹ˆï¼Œè€Œä¸”éå¸¸å‹‡æ•¢åœ°å»è¿½æ±‚ï¼Œæ²¡æœ‰ä¸æ¯«å¦¥åã€‚ç®€çˆ±å¿˜ä¸æ‰ç½—åˆ‡æ–¯ç‰¹ï¼Œåé¢å‘ç°ä»–çš„é™¨è½å¹¶æ²¡æœ‰æ”¾å¼ƒç›¸çˆ±ï¼Œè€Œä¸”åœ¨å¾—çŸ¥ç½—åˆ‡æ–¯ç‰¹å› ä¸ºæ•¢äºç‰ºç‰²è‡ªå·±çš„é«˜å°šå“è´¨ï¼Œæ›´åŠ åšä¿¡äº†è‡ªå·±çš„é€‰æ‹©ã€‚ç®€çˆ±å’Œç½—åˆ‡æ–¯ç‰¹çš„å‘è‡ªå†…å¿ƒæ·±å¤„çš„äº¤æµå¯¹è¯ï¼Œæ¯”è¾ƒå°è±¡æ·±åˆ»ï¼Œä¸¤äººçš„çˆ±æƒ…çœŸçš„æ˜¯åšè´ä¸æ¸ï¼Œæ²¡æœ‰å‚²æ…¢ä¸åè§ï¼Œè€Œæ˜¯çœŸæ­£çš„ç›¸çˆ±ï¼Œæœ€åä¸¤äººå¹¸ç¦æ…¢æ…¢å˜å¾—ç¾å¥½ï¼Œæ„Ÿåˆ°éå¸¸æ¬£æ…°ã€‚\nä»æ—è§‚è€…è§†è§’æ¥çœ‹ï¼Œç®€çˆ±çš„æˆé•¿å†ç¨‹å…·æœ‰é‡è¦çš„è­¦ä¸–æ•™è‚²æ„ä¹‰ã€‚ç®€çˆ±å¹´å°‘æ—¶ç»å—äº†ç«¥å¹´åˆ›ä¼¤å’Œè‹¦éš¾ï¼Œä½†åšå®šåœ°ç»´æŠ¤è‡ªå·±çš„ç‹¬ç«‹è‡ªå°Šäººæ ¼ï¼Œåšå¼ºå‹‡æ•¢åœ°é¢å¯¹é‡é‡å›°éš¾ã€‚é‡åˆ°çˆ±æƒ…æ—¶ä¹ŸåšæŒè‡ªå·±çš„ä¸»è§ï¼Œå§‹ç»ˆè‡ªå°Šè‡ªçˆ±ã€‚\nå¾ˆå¹¸è¿è¯»å®Œè¿™æœ¬ä¹¦ï¼Œä»æ­¤æˆ‘çš„å¿ƒä¸­å¤šäº†ä¸€ä½ç®€çˆ±è¿™æ ·ä»¤äººéš¾å¿˜é’¦ä½©çš„å°è¯´äººç‰©è§’è‰²ã€‚\n","date":"2024-01-27T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/simplelove.jpeg","permalink":"https://soli.seekincs.com/2024/01/%E7%AE%80%E7%88%B1%E5%B0%8F%E8%AF%B4%E8%AF%BB%E5%90%8E%E6%84%9F/","title":"ã€Šç®€çˆ±ã€‹å°è¯´è¯»åæ„Ÿ"},{"content":"ã€Šé©¾é©¶æˆ‘çš„è½¦ã€‹ç”µå½±åˆšçœ‹å®Œå°±æœ‰ä¸€ç§ä¸åä¸å¿«çš„æ„Ÿè§‰ï¼Œæƒ³è®°å½•ä¸‹æ„Ÿå—ï¼ŒæŠŠè®°å¿†ä¹¦é¢åŒ–çš„å†²åŠ¨ã€‚ã€‚ã€‚\nåœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šå®˜æ–¹æ¨èäº†åŒåå°è¯´ï¼Œç®—æ˜¯ä¸è¿™ä¸ªç”µå½±ç›¸é‡çš„å¥‘æœºã€‚å¸¦ç€å°è¯´æ”¹ç¼–çš„ç”µå½±è‚¯å®šä¸é”™çš„åˆ»æ¿å°è±¡ï¼Œæˆ‘æ‰“ç®—ä»Šæ™šæŠŠå®ƒçœ‹å®Œï¼Œè™½ç„¶å®ƒæ—¶é•¿3hã€‚ç”µå½±æ•´ä½“åæ…¢èŠ‚å¥ï¼Œè¿‘åŠå¹´ä¹Ÿçœ‹è¿‡å‡ éƒ¨è¿™ç§ï¼Œä¹Ÿç®—æ˜¯ä¹ æƒ¯äº†ï¼Œæ›´ä½•å†µå¯¹å®ƒæœ‰è¾ƒé«˜çš„æœŸå¾…å’Œå¥½å¥‡å¿ƒã€‚è¿™ç§æ…¢èŠ‚å¥æ›´å®¹æ˜“å…³æ³¨åˆ°â€œå¯¼æ¼”çš„è¯­è¨€â€ï¼Œè™½ç„¶ç¼ºä¹é«˜æ½®å’Œæ˜æ˜¾çš„æƒ…ç»ªæ³¢åŠ¨ï¼Œä½†æ˜¯æˆ‘çš„æ³¨æ„åŠ›å·²ç»è·‘åˆ°é‚£é‡Œé¢å»äº†ã€‚\nè¿™ä¸ªç”µå½±å¾ˆé•¿ï¼Œåˆšçœ‹å®Œï¼Œè„‘æµ·é‡Œè·‘é©¬ç¯ï¼Œä¸€ç›´åœ¨æ‰¾å¯»ä¸€äº›ç‰¹åˆ«å°è±¡è¾ƒæ·±çš„å‰§æƒ…ã€‚\nç”µå½±åˆšå¼€å§‹å°±æ˜¯åŸ‹ä¼ç¬”ï¼Œç”·ä¸»å¦»å­è®²äº†ä¸€ä¸ªå½“æ—¶å¬èµ·æ¥ä¸€å¤´é›¾æ°´çš„æ•…äº‹ï¼Œåé¢ç”·äºŒè¡¥å……äº†æ•…äº‹ç»“å±€æ—¶æ‰å‘ç°æ˜¯ä¸€ç§éšå–»ã€‚ç”·ä¸»è½¦é‡Œæ”¾çš„ç£å¸¦æ˜¯å¦»å­çš„å½•éŸ³ï¼Œä»–ç‹¬è‡ªå¼€è½¦å»å‡ºæ¼”æ—¶ä¼šç»ƒä¹ (å·¥ä½œä¹ æƒ¯)ï¼Œè¿™ä¸ªå¯¹è¯ç‰¹åˆ«æœ‰æ„æ€ï¼Œé—´æ¥è¡¨è¾¾äº†å¦»å­çš„å¿ƒå£°ï¼Œæœ‰ä¸€å¥å°è±¡æ¯”è¾ƒæ·±åˆ»ï¼Œå¥½åƒæ˜¯è¯´æ— æ³•å’ŒæŠ±æ€¨å’Œä»‡æ¨å’Œè§£ã€‚è¿™å¥ä¹Ÿæ˜ å°„äº†ä»–ä¿©ä¹‹é—´éšæ€§çš„çŸ›ç›¾å†²çªï¼Œä»–ç”¨è‡ªå·±çš„æ–¹å¼æ·±çˆ±ç€å¥¹ï¼Œè€Œå¥¹ä¹Ÿæ˜¯ï¼Œä½†æ˜¯å¥¹åœ¨ç”·ä¸»å¿ƒé‡Œæœ‰èƒŒå›çš„å°è±¡ï¼Œä¹Ÿæ˜¯ç”·ä¸»çš„å¿ƒç»“ã€‚\nç”·ä¸»çš„å¿ƒç»“è§£å¼€å‡ ä¹è´¯ç©¿äº†æ•´éƒ¨ç”µå½±ã€‚æ•´ä¸ªè¿‡ç¨‹ç”·ä¸»çš„é¢éƒ¨è¡¨æƒ…éƒ½å¸¦ç€å¿§éƒå’Œå‹æŠ‘ï¼Œåé¢é‡åˆ°äº†å¥³å¸æœºï¼Œä¸¤äººæœ‰ç€ç‰¹åˆ«çš„æœºç¼˜å’Œç›¸ä¼¼ç‚¹ï¼Œæœ€åæ˜¯æ•å¼€å¿ƒæ‰‰ï¼Œå†…å¿ƒå’Œè¿‡å»å’Œè§£ï¼Œè§£å¼€äº†å¿ƒç»“ã€‚è™½ç„¶è¿™æ ·è¯´æƒ…èŠ‚çœ‹èµ·æ¥æœ‰ç‚¹å•è–„ï¼Œä½†å…¶å®ä»”ç»†å›å‘³æ„Ÿè§‰å¾ˆæœ‰ç‹¬å…·åŒ å¿ƒçš„è®¾è®¡ã€‚æ¯”å¦‚ï¼Œè¯å‰§çš„æ¼”å‘˜é¢è¯•é€‰äººï¼Œå€™é€‰äººæ˜¯å„å›½è¯­è¨€ï¼Œè¿™é‡Œåº”è¯¥ä¹Ÿæ˜¯å½±å°„å‡ºæƒ³è¡¨è¾¾è¦æ‡‚äº’ç›¸çš„è¯­è¨€ï¼Œè€Œä¸ä»…æ˜¯å£è¯­ã€‚æ‰‹è¯­é‚£æ®µéå¸¸çš„å‡ºå½©ç»™äººå°è±¡æ·±åˆ»ï¼Œåªè¦ç”¨å¿ƒå“ªæ€•æ‰‹è¯­ä¹Ÿèƒ½äº§ç”Ÿæ›´ç¨³å®šçš„è¿ç»“ã€‚\nç”µå½±é‡Œæœ‰ä¸€ä¸ªååœºé¢ï¼Œç”·ä¸»å’Œå¥³å¸æœºååœ¨è½¦é‡Œé«˜ä¸¾ç€çƒŸä¼¸å‡ºè½¦é¡¶å¤–ï¼Œä»¿ä½›åƒæ˜¯å®£å‘Šå¼€å§‹ç›´é¢è‡ªå·±çš„å†…å¿ƒã€‚\nåœ¨æ­¤ä¹‹å‰ï¼Œç”·ä¸»å’Œç”·äºŒè®²è¿°ç”µå½±å¼€å¤´é‚£ä¸ªæ•…äº‹ååŠéƒ¨åˆ†ï¼Œå¬å¾—æ‡µæ‡µæ‡‚æ‡‚ï¼Œç‰¹åˆ«æ˜¯é‚£ä¸ªå…«ç›®é³—ï¼ŒåŸæ¥ä¹Ÿæ˜¯éšå–»ã€‚ç”·äºŒçš„äººç‰©è®¾å®šè›®æœ‰è¶£çš„ï¼Œä¸èƒ½æ§åˆ¶å¥½è‡ªå·±çš„æƒ…ç»ªå’Œè¡Œä¸ºï¼Œè‡ªå·±ä¹Ÿè¯´è‡ªå·±å¿ƒé‡Œç©ºè¡è¡çš„ã€‚ç”µå½±é‡Œå‡ºç°äº†å¥‘ç§‘å¤«çš„èˆå°å‰§ï¼Œæœ¬æ¥æ˜¯ç”·ä¸»å‡ºæ¼”ç”·ä¸€å·ï¼Œæ€•å› ä¸ºå’Œè§’è‰²å¤ªå¼ºçƒˆçš„å…±é¸£è€Œäº²è‡ªå¯¼æ¼”ï¼Œæœ€åè¿˜æ˜¯ä»–ä¸Šåœºå’Œç›´é¢å†…å¿ƒæ·±å¤„çš„è‡ªå·±ã€‚è¿™ä¸ªèˆå°å‰§æ˜¯è®²è¿°å¦‚ä½•é¢å¯¹äººç”Ÿçš„è‹¦éš¾ï¼Œè€Œå‰§ä¸­å¥³ä¸»çš„æ‰‹è¯­è¶…è¶Šäº†è¯­è¨€æœ¬èº«ï¼Œéå¸¸æ²»æ„ˆã€‚\nç”µå½±å¾ˆå¤šæ—¶å€™éƒ½æ˜¯åœ¨è½¦ä¸Šï¼Œå¥³å¸æœºå’Œç”·ä¸»çš„å¥³å„¿å¹´é¾„ä¸€è‡´ï¼Œéšç€é€æ¸çš„ä¿¡ä»»å’Œæ•å¼€å¿ƒæ‰‰ï¼Œå‘ç°å¥³å¸æœºä¹Ÿæœ‰è·Ÿä»–ç±»ä¼¼çš„ç—›è‹¦çš„è¿‡å¾€ç»å†ï¼Œä¸¤äººå»åˆ°äº†å¥³å¸æœºçš„æ—©å·²ä¸åœ¨çš„è€å®¶ï¼Œå¥¹ä¸è‡ªå·±çš„ç²¾ç¥å¼‚å¸¸çš„æ¯äº²å’Œè§£ã€‚éšåï¼Œå¥³å¸æœºçš„è¿™ç•ªä¸¾åŠ¨æ‰“åŠ¨äº†ç”·ä¸»ï¼Œä¹Ÿè®©ç”·ä¸»æœ€ç»ˆç›¸ä¿¡äº†å¦»å­çš„å¦ä¸€ç§è¡¨è¾¾æ–¹å¼çš„çˆ±ï¼Œç›´é¢äº†è‡ªå·±çš„æ‚”æ¨ï¼Œæ”¾ä¸‹äº†è¿‡å»ã€‚\nçœ‹å®Œè¿™ä¸ªç”µå½±ï¼Œå…¶å®å¿ƒé‡Œæœ‰ä¸€ç‚¹éš¾å—ï¼Œæ„Ÿè§‰äººä¸äººä¹‹é—´çš„æ²Ÿé€šäº¤æµç›¸å¤„çœŸçš„ä¸ç®€å•ï¼Œå¯èƒ½äººæœ¬èº«å°±æ˜¯å¤æ‚çš„ï¼Œè¿™æ˜¯éå¸¸é‡è¦çš„æŠ€èƒ½ï¼Œéœ€è¦ç»ˆèº«å­¦ä¹ ã€‚è¿˜æ˜¯ä¼šæƒ³ï¼Œå¦‚æœç”·ä¸»å’Œå¦»å­æ—©ä¸€ç‚¹æ•å¼€å¿ƒæ‰‰ï¼Œå¤šä¸€äº›ä¿¡ä»»å’ŒåŒ…å®¹ï¼Œç»“å±€åº”è¯¥ä¼šä¸ä¸€æ ·å§ã€‚\næ•´ä½“æ¥è¯´ï¼Œè¿™ä¸ªç”µå½±æŒºæœ‰å¯å‘ï¼Œå½“æˆ‘ä»¬é¢å¯¹ç”Ÿæ´»ä¸­çš„ç—›è‹¦ï¼Œä¸åº”è¯¥é€‰æ‹©å‹æŠ‘è‡ªå·±çš„å†…å¿ƒæ„Ÿå—ï¼Œä¸åº”è¯¥é€ƒé¿ï¼Œè¦æƒ³åŠæ³•è§£å†³é—®é¢˜ï¼Œé€‰æ‹©æ­£ç¡®çš„æ–¹å¼ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ã€‚\n","date":"2024-01-26T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/takemycar.webp","permalink":"https://soli.seekincs.com/2024/01/%E9%A9%BE%E9%A9%B6%E6%88%91%E7%9A%84%E8%BD%A6%E7%94%B5%E5%BD%B1%E8%A7%82%E5%90%8E%E6%84%9F/","title":"ã€Šé©¾é©¶æˆ‘çš„è½¦ã€‹ç”µå½±è§‚åæ„Ÿ"},{"content":"çªç„¶æƒ³å†™ä¸€ä¸‹ã€Šç¦»å©šã€‹å°è¯´è¯»åæ„Ÿï¼Œå¯èƒ½ä¹Ÿæœ‰ä¸€ç§ä¸åä¸å¿«çš„å†²åŠ¨å§ã€‚\nä¸Šä¸ªæœˆåœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šç²—è¯»å®Œè¿™ä¸ªå°è¯´ï¼Œå¤§æ¦‚èŠ±äº†4.5hï¼Œå› ä¸ºå°è¯´ä¸»é¢˜çš„ç‰¹æ®Šæ€§ï¼Œæ‰€ä»¥å°è±¡å¾ˆæ·±åˆ»ã€‚å‰äº›å¤©çœ‹å®Œäº†åŒåç”µå½±ï¼Œéšåçœ‹äº†ä¸‹ç”µå½±è§£è¯´ï¼Œæ„Ÿè§‰ç†è§£æ›´åŠ å…¨é¢äº†äº›ã€‚\nå½“æ—¶äº†è§£åˆ°å°è¯´ï¼Œæ˜¯å› ä¸ºä¹¦ä¸­çš„ä¸€æ®µé¢‡ä¸ºæµä¼ çš„åŸæ–‡ï¼šâ€œæˆ‘å¹¶ä¸æƒ³å°å°æ‹çˆ±çš„æ»‹å‘³ï¼Œæˆ‘è¦è¿½æ±‚çš„æ˜¯ç‚¹â€”â€”è¯—æ„â€ï¼Œç®—å¾—ä¸Šæ˜¯å› ä¸ºä¸€æ®µè¯è¿½å®Œä¸€éƒ¨å°è¯´å§ã€‚è¯—æ„æ˜¯å°è¯´ä¸­æœ€æ ¸å¿ƒçš„å…³é”®è¯ï¼Œæ˜¯ä¸»äººå…¬è€ææ‰€è¿½æ±‚çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯—æ„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\nç¬¬ä¸€æ¬¡ç²—è¯»å®Œå°è¯´ï¼Œæˆ‘è‡ªä»¥ä¸ºè€æçš„è¯—æ„å°±æ˜¯è¿½æ±‚é©¬å¤§å«‚ã€‚åé¢çœ‹å®Œç”µå½±å’Œè§£è¯´ï¼Œæˆ‘å‘ç°æˆ‘ç†è§£ç”šæµ…ã€‚æˆ‘ç”šè‡³æ²¡æœ‰å‘è§‰å’Œè®¤çœŸæ€è€ƒè¿‡è¿™ä¸ªé—®é¢˜ï¼Œåªæ˜¯ä¸ºäº†è¯»è€Œè¯»ï¼Œæ²¡æœ‰å»è¿›ä¸€æ­¥çš„å‰–æã€‚ç»“åˆè€æçš„æ—¶ä»£èƒŒæ™¯ã€ç”Ÿæ´»ç»å†ã€æ€§æ ¼èŒä¸šç­‰ï¼Œå¯èƒ½ä¼šæ‰¾åˆ°ç­”æ¡ˆã€‚\nå½“æ—¶æ˜¯æ°‘å›½æ—¶æœŸï¼Œè€æåœ¨è´¢æ”¿æ‰€ä¸Šç­ï¼Œæ˜¯ä¸€ä¸ªæœ‰ç€ç²¾ç¥è¿½æ±‚çš„çŸ¥è¯†åˆ†å­çš„å°äººç‰©ã€‚è€ææ€§æ ¼è€å®ï¼Œæœ‰äº›ç²¾ç¥å†…è€—ï¼Œæœ‰ä¸ªäººæ€æƒ³ï¼Œæœ‰ç€å¯¹ä¼ ç»Ÿçš„å©šå§»åˆ¶åº¦çš„æ‰¹åˆ¤ï¼Œæœ‰ç€å¯¹è´¢æ”¿æ‰€çš„èŒåœºçš„ä¸å–œæ¬¢ã€‚å°è¯´åå«ç¦»å©šï¼Œåˆ°åº•è°åœ¨ç¦»å©šï¼Ÿé¦–å…ˆæ˜¯è€ææƒ³ç¦»å©šï¼Œå¼ å¤§å“¥å’Œä»–æƒ³æ³•ç›¸åï¼Œæƒ³åŠå¯¼ä»–ï¼Œåˆ†åˆ«ä»£è¡¨äº†æ–°æ—§æ€æƒ³ã€‚è€æéå¸¸è‹¦é—·ï¼Œåœ¨ç»å†äº†ä¸€æ®µè‡ªæˆ‘æ„Ÿè§‰ä¸æ»¡çš„å©šå§»ç”Ÿæ´»åï¼Œæ‰å‘ç°è‡ªå·±æƒ³è¦çš„æ˜¯ä¸€ç‚¹è¯—æ„ï¼Œè¿™ä¸ªè¯—æ„åœ¨é‚»å±…é©¬å¤§å«‚å‡ºç°åï¼Œå°±æ›´åŠ å…·è±¡åŒ–äº†ã€‚\nçœ‹å°è¯´ä¸­çš„é©¬å¤§å«‚æè¿°ï¼Œå¯¹å…¶å°è±¡æ²¡æœ‰ç”µå½±ä¸­çš„æ·±åˆ»ä¸€äº›ã€‚ç”µå½±ä¸­çš„æ›´å®¹æ˜“çœ‹å‡ºä¸è€æå¦»å­çš„æ˜æ˜¾å·®åˆ«ï¼Œæ— è®ºæ˜¯æ‰“æ‰®æ°”è´¨æ–‡åŒ–éƒ½æ›´åŠ çªå‡ºã€‚ç‰¹åˆ«æ˜¯æœ‰ä¸ªé•œå¤´ï¼Œè€æå¦»å­å’Œé©¬å¤§å«‚åœ¨åº­é™¢åƒæ¨±æ¡ƒï¼Œè€æå¯¹å¦»å­çš„åŠ¨ä½œæœ‰äº›ä¸æ»¡ï¼Œè€Œä¸”è¿™ç§ä¸æ»¡å¤šæ¬¡ç´¯ç§¯ï¼Œè€Œé©¬å¤§å«‚çš„åŠ¨ä½œä¼˜é›…2ï¼Œè€æé»˜é»˜åœ°è§‚çœ‹ç€ï¼Œè„¸ä¸Šéœ²å‡ºäº†çˆ±æ…•çš„è¡¨æƒ…ã€‚å› ä¸ºé©¬å¤§å«‚çš„ä¸ˆå¤«ç¦»å¼€ï¼Œè€æè§‰å¾—æœ‰ä¸€ç‚¹å¸Œæœ›ï¼Œè€æå¿ƒçŒ¿æ„é©¬ï¼Œæƒ³é€ƒç¦»ä¸å¦‚æ„çš„å®¶åº­ç”Ÿæ´»ï¼Œè€æä¸ç”˜å¿ƒå¯¹ç°å®å¦¥åï¼Œä½†åˆå½·å¾¨çŸ›ç›¾ï¼Œæ€•å¦»å­é—¹å’Œå©šå§»åˆ¶åº¦å’Œé“å¾·æŸç¼šã€‚å¯æ˜¯æœ€åæƒ…èŠ‚æœ‰åè½¬ï¼Œé©¬å¤§å«‚çš„ä¸ˆå¤«å›æ¥åˆå’Œå¥½äº†ï¼Œè¿™æ—¶è€ææ‰å½»åº•å¿ƒå‡‰æ”¾å¼ƒäº†ã€‚ ä¸äºŒçˆ·è¿™ä¸ªè§’è‰²æŒºç‰¹åˆ«çš„ï¼Œä¸ºäººé‡æƒ…é‡ä¹‰ï¼Œä¸ºäº†æŠ¥æ©å¼ å¤§å“¥è€ŒçŠ¯ç½ªã€‚ä¸äºŒçˆ·åœ¨ç”µå½±ä¸­ç»å¸¸å‡ºç°çš„é•œå¤´æ˜¯æ‰‹æç€é¸Ÿç¬¼ï¼Œè¿™ä¸ªç”»é¢å°è±¡å¤ªæ·±åˆ»äº†ï¼Œç¬¼ä¸­é¸Ÿæ˜æ˜¾æ˜¯éšå–»ï¼Œå¤ªæ˜æ˜¾äº†ã€‚å´å¤ªå¤ªè¿™ä¸ªè§’è‰²ä¹ŸæŒºæœ‰ä»£è¡¨æ€§ï¼Œä¸ç‹¬ç«‹ï¼Œå¥½åƒæ‡’åšï¼Œæ·±åº¦ä¾èµ–ä¸ˆå¤«ï¼Œç”šè‡³å¥¹çš„æœ‰å¥å°è¯å°è±¡å¾ˆæ·±åˆ»ï¼šâ€œç¦»äº†å©šæˆ‘åƒè°å»â€ï¼Œæ›´åŠ æš´éœ²äº†å¥¹çš„é—®é¢˜ã€‚è´¢æ”¿æ‰€è¿™é‡Œä¹Ÿæœ‰ä¸€äº›è®½åˆºçš„åœ°æ–¹ï¼Œå¼ å¤§å“¥å‡ºäº†äº‹ï¼Œè€æå‘¼ååŒäº‹å‡ºæ‰‹å¸®å¿™ï¼Œæ²¡æƒ³åˆ°å¤§å®¶åªæ˜¯æ•·è¡ï¼Œç”šè‡³ä¸€å¿ƒåªæƒ¦è®°ç©ºå‡ºæ¥çš„ä½ç½®ã€‚è€æå¯¹èŒåœºä¸€æ¬¡æ¬¡çš„å¤±æœ›ï¼Œæœ€åæ˜¯è¿”å›äº†ä¹¡ä¸‹ã€‚\nå¦‚æœæŠŠè‡ªå·±ä»£å…¥è€æçš„è§’è‰²ï¼Œä¼šæ€ä¹ˆåšé€‰æ‹©å‘¢ï¼Ÿæ˜¯é€‰æ‹©å’Œç°å®å¦¥åï¼Œè¿˜æ˜¯æ‰§ç€åœ°è¿½æ±‚è¯—æ„å‘¢ï¼Ÿå¯èƒ½ä¸–ä¸Šæ ¹æœ¬æ²¡æœ‰è¯—æ„ï¼Œæ›´å¤šçš„æ˜¯å¦¥åï¼Œç°å®çš„å¼•åŠ›æœ‰äº›æ²‰é‡ï¼Œä½†æ˜¯ä¹Ÿè¦å»è¿½æ±‚ä¸æ˜¯å—ã€‚\næ€»çš„æ¥è¯´ï¼Œæ„Ÿè§‰å°è¯´æƒ…èŠ‚æ¯”è¾ƒç®€å•ï¼Œç”šè‡³æœ‰ä¸€ç§ä¸€æ°”å‘µæˆçš„æ„Ÿè§‰ï¼Œæ–‡å­—ä¹Ÿæ¯”è¾ƒå¹½é»˜ã€‚å°è¯´åå«ç¦»å©šï¼Œä½†æ²¡æœ‰ä¸€äººç¦»å©šï¼Œæ˜¯ä»¥ç¦»å©šä¸ºçº¿ç´¢ï¼Œæ­éœ²äº†ä¸€äº›å½“æ—¶ç¤¾ä¼šå­˜åœ¨çš„çŸ›ç›¾ã€‚è€èˆæŠ½è±¡å‡ºäº†â€œè¯—æ„â€è¿™ä¸ªå…·æœ‰è±¡å¾æ€§çš„æ¦‚å¿µï¼Œæ„Ÿè§‰éå¸¸æœ‰è¶£ï¼Œå«è“„å§”å©‰ã€‚éå¸¸åº†å¹¸çœ‹å®Œè¿™ä¸ªå°è¯´ï¼Œæœ‰å¾ˆå¤§çš„å¯å‘æ„ä¹‰ï¼Œå®ƒåœ¨è­¦ç¤ºæˆ‘ä»¬ä¸è¦å¿˜è®°å¯¹çˆ±æƒ…å’Œç†æƒ³çš„è¿½æ±‚ã€‚\n","date":"2024-01-26T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/lihun.jpeg","permalink":"https://soli.seekincs.com/2024/01/%E7%A6%BB%E5%A9%9A%E5%B0%8F%E8%AF%B4%E8%AF%BB%E5%90%8E%E6%84%9F/","title":"ã€Šç¦»å©šã€‹å°è¯´è¯»åæ„Ÿ"},{"content":"ä¹¦åï¼šè®¡ç®—æœºçš„å¿ƒæ™ºæ“ä½œç³»ç»Ÿä¹‹å“²å­¦åŸç†\nAs you will(æ„æ„¿ã€å°†è¦) ä»€ä¹ˆæ˜¯è®¡ç®—æœºçš„æ ¹æœ¬ç‰¹å¾ï¼Ÿ(äººé€ å­¦ç§‘çš„4ä¸ªç‰¹ç‚¹) ä¸€ä¸ªè¿åŠ¨ä¸­çš„ç¨‹åºï¼Œå³è¿›ç¨‹ è®¡ç®—æœºç¨‹åºæ˜¯æ€æ ·è¿è¡Œçš„å‘¢ï¼Ÿä¸€ä¸ªä»ç¨‹åºåˆ°å¾®æŒ‡ä»¤æ‰§è¡Œçš„æ•´ä¸ªè¿‡ç¨‹ ç¨‹åºçš„è¿è¡Œè‡³å°‘éœ€è¦å“ª4ä¸ªå› ç´ ï¼Ÿ æ“ä½œç³»ç»Ÿåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ æ“ä½œç³»ç»Ÿåˆ°åº•æ“æ§ä»€ä¹ˆäº‹æƒ…ï¼Ÿ æ“ä½œç³»ç»Ÿæ‰€æ‰®æ¼”çš„ä¸¤ä¸ªæ ¹æœ¬è§’è‰²ï¼Ÿ æ€ä¹ˆè®©ç”¨æˆ·å¾ˆå¥½åœ°åˆ©ç”¨è¿™äº›ç¡¬ä»¶èµ„æºå‘¢ï¼Ÿ æ“ä½œç³»ç»Ÿè¦å®Œæˆçš„ä»»åŠ¡å…·ä½“æœ‰å“ªäº›å‘¢ï¼Ÿ4ä¸ªç®¡ç† ä»…ä»…æ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿé‡è¦å°±è¦å­¦ä¹ å®ƒå—ï¼Ÿè§¦ç±»æ—é€šã€å¥½å¥‡å¿ƒ æ“ä½œç³»ç»Ÿä¸ºä»€ä¹ˆæ˜¯ç°åœ¨è¿™ä¸ªæ ·å­ï¼Œä»¥åŠå°†æ¥ä¼šæ˜¯ä»€ä¹ˆæ ·å­ æ“ä½œç³»ç»Ÿçš„ä¸æ–­å‘å±•ä¸æ”¹å–„ç”±ä¸¤ä¸ªå› ç´ é©±åŠ¨ï¼Ÿ é©±åŠ¨æ“ä½œç³»ç»Ÿå‘å±•çš„ä¸»è¦åŠ¨åŠ›æœ‰å“ªäº›ï¼Ÿå®ƒä»¬æ˜¯å¦‚ä½•é©±åŠ¨çš„ï¼Ÿ å·®ä¸å¤šç²¾ç¥ æ€æ ·ç†è§£æŠ½è±¡ï¼Ÿ è¿›ç¨‹å‡ºç°çš„åŠ¨æœºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ è¿›ç¨‹ç®¡ç†è¦å¤„ç†çš„æœ€å¤§é—®é¢˜ï¼Ÿ ","date":"2023-11-08T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img1.png","permalink":"https://soli.seekincs.com/2023/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%BF%83%E6%99%BA%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/","title":"è®¡ç®—æœºå¿ƒæ™ºè¯»ä¹¦ç¬”è®°"},{"content":"\nèƒŒæ™¯ ç¼©çŸ­ä»éœ€æ±‚åˆ°ä¸Šçº¿çš„è·ç¦»\næœåŠ¡ç«¯èµ„æºæˆæœ¬ å·¥ç¨‹æ•ˆç‡ è®¾è®¡ç†å¿µ é«˜æ€§èƒ½ ä¿è¯æ˜“ç”¨æ€§å’Œé€šç”¨æ€§çš„å‰æä¸‹ï¼Œè¿½æ±‚æ€§èƒ½æè‡´ æ’ä»¶åŒ– æ”¯æŒä¸šåŠ¡å¯¹æ¡†æ¶æ³¨å…¥è‡ªå®šä¹‰å¤„ç†ï¼Œå¢å¼ºæ‰©å±•èƒ½åŠ›å’Œçµæ´»åº¦ æµ‹è¯• å•å…ƒæµ‹è¯•è¦†ç›–ç‡100%ï¼Œæä¾›å·¥å…·é“¾æ–¹ä¾¿ä¸šåŠ¡æµ‹è¯• æ•´ä½“å½¢æ€ æ ‡å‡†åŒ–ã€æ¨¡å—åŒ–ã€æ’ä»¶åŒ–ã€æ˜“æ‰©å±•ã€‚\nåè®®è®¾è®¡ åè®®æŠ¥æ–‡ï¼šå¸§å¤´+åŒ…å¤´+åŒ…ä½“ã€‚\nå¸§å¤´æ˜¯å›ºå®šçš„16ä¸ªå­—èŠ‚ã€‚\nåŒ…å¤´å’ŒåŒ…ä½“å¯å˜é•¿ã€‚åŒ…å¤´é€šè¿‡pbåºåˆ—åŒ–æ–¹å¼ï¼ŒåŒ…ä½“æ”¯æŒä¸šåŠ¡è‡ªå®šä¹‰åºåˆ—åŒ–æ–¹å¼ã€‚ åè®®æ‰“è§£åŒ…è¿‡ç¨‹å…¨å‰–æ codecæ˜¯åè®®æ‰“è§£åŒ…çš„ç»Ÿä¸€æ¥å£ã€‚\nrpcæ¡†æ¶å†…éƒ¨ä¼šé€šè¿‡åè®®å(æ¯”å¦‚http/grpcç­‰)è‡ªåŠ¨è·å–å¯¹åº”åè®®çš„Codecæ¥å£å®ç°ï¼Œä¹Ÿå°±æ˜¯clientCodecå’ŒserverCodecåˆ†åˆ«å®ç°client-\u0026gt;serverå‘åŒ…å’Œè§£åŒ…ã€server-\u0026gt;clientè§£åŒ…å’Œå›åŒ…ã€‚ RPCè°ƒç”¨ åŸºäºprotocæ–‡ä»¶çš„rpcè°ƒç”¨å®ç° å…³é”®ä»£ç ï¼šproxy := pb.NewGreeterClientProxy(opts\u0026hellip;)\nåŸºäºPBå®ç°,é€šè¿‡æä¾›è„šæ‰‹æ¶å·¥å…·ç”Ÿæˆæ¥å£ä»£ç ,å¹¶ç”ŸæˆæœåŠ¡æ¨¡æ¿,å®ç°ä¸šåŠ¡å¿«é€Ÿå¼€å‘ã€‚ æœåŠ¡äº¤äº’æµç¨‹ æ’ä»¶åŒ–æ¶æ„ é€šè¿‡æ¡†æ¶é…ç½®æ–‡ä»¶æˆ–importçš„æ–¹å¼ï¼Œæ˜“æ’æ‹”ï¼Œæ‰©å±•çµæ´»ã€‚ æ’ä»¶åŸç† æ¡†æ¶å®šä¹‰äº†æ¯ç§æ’ä»¶ç±»å‹çš„æ ‡å‡†æ¥å£ã€‚\næ²¡æœ‰å…·ä½“å®ç°,åªæä¾›mapæ³¨å†Œæ–¹å¼ã€‚\nä¸šåŠ¡ä»£ç importå³å¯ã€‚ æœåŠ¡æ²»ç† ç»Ÿä¸€æ ‡å‡†åŒ–æ¥å£ï¼Œçµæ´»æ˜“æ‰©å±•ã€‚\né€šè¿‡æ’ä»¶å¯¹æ¥æœåŠ¡æ²»ç†ç›¸å…³ç³»ç»Ÿ,çµæ´»ç»„è£…è‡ªå·±çš„å¾®æœåŠ¡ä½“ç³»ã€‚\næ’ä»¶ç±»å‹ ä»£è¡¨ å…·ä½“å®ç° åå­—æœåŠ¡ åŒ—ææ˜Ÿ(å·²å¼€æº) æœåŠ¡æ³¨å†Œï¼š\nserverç«¯main.goé‡Œä¼šimportåŒ—ææ˜ŸæœåŠ¡æ³¨å†Œæ’ä»¶ã€‚rpcæ¡†æ¶ä¼šåœ¨æœåŠ¡ç«¯å£èµ·æ¥åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨registeræ¥å£ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨å°†æœåŠ¡åä¸ip_portä¿¡æ¯æ³¨å†Œåˆ°åŒ—ææ˜Ÿã€‚\næœåŠ¡å‘ç°ï¼š\nclientç«¯main.goé‡Œä¼šimportåŒ—ææ˜ŸæœåŠ¡å‘ç°æ’ä»¶ã€‚rpcæ¡†æ¶çš„å†…éƒ¨å°è£…äº†rpcè°ƒç”¨ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨selectæ¥å£ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨æ‹¿åˆ°calleeçš„ip_portã€‚ ç›‘æ§ prometheus rpcæ¡†æ¶å¯¹å¤–å¼€æ”¾counterã€gaugeã€histogramä¸‰ç§ç±»å‹çš„ç›‘æ§ç±»å‹ã€‚æä¾›sinkæ¥å£å°è£…äº†reportåŠŸèƒ½ã€‚\nserverç«¯main.goé‡Œä¼šimport prometheus/statusdç›‘æ§ä¸ŠæŠ¥æ’ä»¶ã€‚é€šè¿‡è¿™ä¸ªæ’ä»¶è‡ªåŠ¨ä¸ŠæŠ¥åˆ°ç›‘æ§å¹³å°ã€‚ é…ç½® etcd rpcæ¡†æ¶æä¾›æœ¬åœ°æ–‡ä»¶å’Œè¿œç¨‹é…ç½®ä¸­å¿ƒé‚£ç§æ–¹å¼ï¼ŒæŠ½è±¡å‡ºprovideræ ‡å‡†åŒ–æ¥å£ã€‚æä¾›å¤šç§åºåˆ—åŒ–æ–¹å¼ã€‚ è°ƒç”¨é“¾ jaeger rpcæ¡†æ¶çš„åŒ…å¤´å¯å˜é•¿ï¼Œå…¶ä¸­åŒ…å«metadataä¿¡æ¯ï¼Œå¹¶å¯¹å¤–æš´éœ²getå’Œsetæ ‡å‡†æ¥å£ï¼Œå¯ç”¨äºé›†æˆæœåŠ¡å¯è§‚æµ‹æ€§åŠŸèƒ½ã€‚ æ—¥å¿— zap rpcæ¡†æ¶æ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶é‡Œæ³¨å†Œæ—¥å¿—æ’ä»¶ï¼Œå®ç°æ ¹æ®æ—¥å¿—çº§åˆ«æŒ‰consoleæˆ–fileæ¨¡å¼å†™å…¥æŒ‡å®šæ–‡ä»¶åå¹¶è‡ªåŠ¨æ»šåŠ¨ã€‚ æ‹¦æˆªå™¨ å‡è®¾æœ‰ä¸€ä¸ªæ–¹æ³• handler(ctx context.Context) ï¼Œæˆ‘æƒ³è¦ç»™è¿™ä¸ªæ–¹æ³•èµ‹äºˆä¸€ä¸ªèƒ½åŠ›ï¼šå…è®¸åœ¨è¿™ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹å‰èƒ½å¤Ÿæ‰“å°ä¸€è¡Œæ—¥å¿—ã€‚åŒæ—¶ï¼Œä¿è¯handleræ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡ã€‚ è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨ å®šä¹‰å¤„ç†é€»è¾‘å‡½æ•° æ³¨å†Œåˆ°æ¡†æ¶ä¸­ é…ç½®æ–‡ä»¶å¼€å¯ä½¿ç”¨ ","date":"2023-02-11T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img1.png","permalink":"https://soli.seekincs.com/2023/02/gorpc%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/","title":"gorpcè®¾è®¡ä¸å®ç°"},{"content":"Questions Q1: TCPæœåŠ¡æœ€å¤§å¹¶å‘è¿æ¥æ•°ï¼Ÿ å³æœ‰ä¸€ä¸ª TCP æœåŠ¡ç¨‹åºçš„åœ°å€æ˜¯ 1.2.3.4:8765ï¼Œé—®å®ƒä»ç†è®ºä¸Šèƒ½æ¥å—å¤šå°‘ä¸ªå¹¶å‘è¿æ¥ï¼Ÿ\nå•ç‹¬è°ˆè®ºâ€œTCP å¹¶å‘è¿æ¥æ•°â€æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºè¿æ¥æ•°åŸºæœ¬ä¸Šæ˜¯è¦å¤šå°‘æœ‰å¤šå°‘ã€‚æ›´æœ‰æ„ä¹‰çš„æ€§èƒ½æŒ‡æ ‡æˆ–è®¸æ˜¯ï¼šâ€œæ¯ç§’æ”¶å‘å¤šå°‘æ¡æ¶ˆæ¯â€ã€â€œæ¯ç§’æ”¶å‘å¤šå°‘å­—èŠ‚çš„æ•°æ®â€ã€â€œæ”¯æŒå¤šå°‘ä¸ªæ´»åŠ¨çš„å¹¶å‘å®¢æˆ·â€ç­‰ç­‰ã€‚\nåœ¨åªè€ƒè™‘ IPv4 çš„æƒ…å†µä¸‹ï¼Œå¹¶å‘æ•°çš„ç†è®ºä¸Šé™æ˜¯ 2^48ã€‚è€ƒè™‘æŸäº› IP æ®µè¢«ä¿ç•™äº†ï¼Œè¿™ä¸ªä¸Šç•Œå¯é€‚å½“ç¼©å°ï¼Œä½†æ•°é‡çº§ä¸å˜ã€‚å®é™…çš„é™åˆ¶æ˜¯æ“ä½œç³»ç»Ÿå…¨å±€æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡ï¼Œä»¥åŠå†…å­˜å¤§å°ã€‚\n2^48ç”±æ¥ï¼š ä¸€ä¸ª TCP è¿æ¥æœ‰ä¸¤ä¸ª end pointsï¼Œæ¯ä¸ª end point æ˜¯ {ip, port}ï¼Œé¢˜ç›®è¯´å…¶ä¸­ä¸€ ä¸ª end point å·²ç»å›ºå®šï¼Œé‚£ä¹ˆç•™ä¸‹ä¸€ä¸ª end point çš„è‡ªç”±åº¦ï¼Œå³ 2^48ã€‚å®¢æˆ·ç«¯ IP çš„ä¸Šé™æ˜¯ 2^32 ä¸ªï¼Œæ¯ä¸ªå®¢æˆ·ç«¯ IP å‘èµ·è¿æ¥çš„ä¸Šé™æ˜¯ 2^16ï¼Œä¹˜åˆ°ä¸€èµ·å¾—åˆ°ç†è®ºä¸Šé™\nåœ¨çœŸå®çš„ Linux ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´å†…æ ¸å‚æ•°æ¥æ”¯æŒä¸Šç™¾ä¸‡å¹¶å‘è¿æ¥ã€‚\nQ2: TCP çš„å¯é æ€§æœ‰å¤šé«˜? Realize That TCP Is a Reliable Protocol, Not an Infallible Protocolã€‚\né‚£ä¹ˆ TCP åœ¨å“ªç§æƒ…å†µä¸‹ä¼šå‡ºé”™ï¼Ÿè¿™é‡Œè¯´çš„â€œå‡ºé”™â€æŒ‡çš„æ˜¯æ”¶åˆ°çš„æ•°æ®ä¸å‘é€çš„æ•°æ®ä¸ä¸€è‡´ï¼Œè€Œä¸æ˜¯æ•°æ®ä¸å¯è¾¾ã€‚\nä»€ä¹ˆæƒ…å†µä¸‹ TCP ä¼ é€çš„æ•°æ®ä¼šå‡ºé”™ï¼Ÿ\nIP header å’Œ TCP header çš„ checksum æ˜¯ä¸€ç§éå¸¸å¼±çš„ 16-bit check sum ç®—æ³•ï¼Œ å…¶æŠŠæ•°æ®å½“æˆåç è¡¨ç¤ºçš„ 16-bit integersï¼Œå†åŠ åˆ°ä¸€èµ·ã€‚è¿™ç§ checksum ç®—æ³•èƒ½æ£€å‡º ä¸€äº›ç®€å•çš„é”™è¯¯ï¼Œè€Œå¯¹æŸäº›é”™è¯¯æ— èƒ½ä¸ºåŠ›ã€‚\nè·¯ç”±å™¨å¯èƒ½å‡ºç°ç¡¬ä»¶æ•…éšœï¼Œæ¯”æ–¹è¯´å®ƒçš„å†…å­˜æ•…éšœï¼ˆæˆ–å¶ç„¶é”™è¯¯ï¼‰å¯¼è‡´æ”¶å‘ IP æŠ¥ æ–‡å‡ºç°å¤š bit çš„åè½¬æˆ–åŒå­—èŠ‚äº¤æ¢ï¼Œè¿™ä¸ªåè½¬å¦‚æœå‘ç”Ÿåœ¨ payload åŒºï¼Œé‚£ä¹ˆæ— æ³•ç”¨ é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚çš„ check sum æŸ¥å‡ºæ¥ï¼Œåªèƒ½é€šè¿‡åº”ç”¨å±‚çš„ check sum æ¥æ£€ æµ‹ã€‚\nå¦å¤–ä¸€ä¸ªä¾‹è¯ï¼šä¸‹è½½å¤§æ–‡ä»¶çš„æ—¶å€™ä¸€èˆ¬éƒ½ä¼šé™„ä¸Š MD5ï¼Œè¿™é™¤äº†æœ‰å®‰å…¨æ–¹é¢çš„è€ƒ è™‘ï¼ˆé˜²æ­¢ç¯¡æ”¹ï¼‰ï¼Œä¹Ÿè¯´æ˜åº”ç”¨å±‚åº”è¯¥è‡ªå·±è®¾æ³•æ ¡éªŒæ•°æ®çš„æ­£ç¡®æ€§ã€‚è¿™æ˜¯ end-to-end principle çš„ä¸€ä¸ªä¾‹è¯ã€‚\nQ4: TCPå¦‚ä½•å®ç°å¯é ï¼Ÿ TCP ä½œä¸ºä¸€ä¸ªå¯é çš„ä¼ è¾“å±‚åè®®ï¼Œå…¶æ ¸å¿ƒæœ‰ä¸‰ç‚¹ï¼š\nPositive acknowledgement with retransmissionï¼› Flow control using sliding window ï¼ˆåŒ…æ‹¬ Nagle ç®—æ³•ç­‰ï¼‰ï¼› Congestion control ï¼ˆåŒ…æ‹¬ slow startã€congestion avoidanceã€fast retransmit ç­‰ï¼‰ã€‚ ç¬¬ä¸€ç‚¹å·²ç»è¶³ä»¥æ»¡è¶³â€œå¯é æ€§â€è¦æ±‚ï¼ˆä¸ºä»€ä¹ˆï¼Ÿï¼‰ï¼›ç¬¬äºŒç‚¹æ˜¯ä¸ºäº†æé«˜ååé‡ï¼Œå…… åˆ†åˆ©ç”¨é“¾è·¯å±‚å¸¦å®½ï¼›ç¬¬ä¸‰ç‚¹æ˜¯é˜²æ­¢è¿‡è½½é€ æˆä¸¢åŒ…ã€‚æ¢è¨€ä¹‹ï¼Œç¬¬äºŒç‚¹æ˜¯é¿å…å‘å¾—å¤ªæ…¢ï¼Œ ç¬¬ä¸‰ç‚¹æ˜¯é¿å…å‘å¾—å¤ªå¿«ï¼ŒäºŒè€…ç›¸äº’åˆ¶çº¦ã€‚ä»åé¦ˆæ§åˆ¶çš„è§’åº¦çœ‹ï¼ŒTCP åƒæ˜¯ä¸€ä¸ªè‡ªé€‚åº” çš„èŠ‚æµé˜€ï¼Œæ ¹æ®ç®¡é“çš„æ‹¥å µæƒ…å†µè‡ªåŠ¨è°ƒæ•´é˜€é—¨çš„æµé‡ã€‚ Q3: C10Ké—®é¢˜ï¼Ÿ whatï¼šæ‰€è°“C10Ké—®é¢˜ï¼Œå°±æ˜¯Client 10000 Problemï¼Œå³â€œåœ¨åŒæ—¶è¿æ¥åˆ°æœåŠ¡å™¨çš„å®¢æˆ·ç«¯æ•°é‡è¶…è¿‡10000ä¸ªçš„ç¯å¢ƒä¸­ï¼Œå³ä¾¿ç¡¬ä»¶æ€§èƒ½è¶³å¤Ÿï¼Œä¾ç„¶æ— æ³•æ­£å¸¸æä¾›æœåŠ¡â€è¿™æ ·ä¸€ä¸ªé—®é¢˜\nwhat: æ‰€è°“æœ€å¼±è¿æ¥é—®é¢˜ï¼Œå°±æ˜¯å¦‚æœå¾€ä¸¤ç«¯ç”¨åŠ›æ‹‰ä¸€æ¡ç”±å¾ˆå¤šç¯ï¼ˆè¿æ¥ï¼‰ç»„æˆçš„é”é“¾ï¼Œå…¶ä¸­æœ€è„†å¼±çš„ä¸€ä¸ªè¿æ¥ä¼šå…ˆæ–­æ‰ã€‚å› æ­¤ï¼Œé”é“¾æ•´ä½“çš„å¼ºåº¦å–å†³äºå…¶ä¸­æœ€è„†å¼±çš„ä¸€ç¯ã€‚å®‰å…¨é—®é¢˜ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæ•´ä½“çš„å¼ºåº¦å–å†³äºå…¶ä¸­æœ€è„†å¼±çš„éƒ¨åˆ†ã€‚\nQ6: å¸¸è§çš„å¹¶å‘ç½‘ç»œæœåŠ¡ç¨‹åºè®¾è®¡æ–¹æ¡ˆ ","date":"2022-12-03T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img1.png","permalink":"https://soli.seekincs.com/2022/12/linux%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%BC%96%E7%A8%8B%E4%BD%BF%E7%94%A8muduo-c-%E7%BD%91%E7%BB%9C%E5%BA%93.pdf/","title":"Linuxå¤šçº¿ç¨‹æœåŠ¡ç«¯ç¼–ç¨‹ï¼šä½¿ç”¨muduo C++ç½‘ç»œåº“.pdf"},{"content":"Questions Q1:masterä¸workerè¿›ç¨‹é€šä¿¡æ–¹å¼ï¼Ÿ å³masterè¿›ç¨‹å¦‚ä½•é€šçŸ¥workerè¿›ç¨‹åœæ­¢æœåŠ¡æˆ–æ›´æ¢æ—¥å¿—æ–‡ä»¶å‘¢ï¼Ÿ å¯¹äºè¿™æ ·æ§åˆ¶è¿›ç¨‹è¿è¡Œçš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼ŒNginxé‡‡ç”¨çš„æ˜¯ä¿¡å·ã€‚è§ngx_signal_handleræ–¹æ³•ã€‚\nåœ¨ngx_worker_process_cycleæ–¹æ³•ä¸­ï¼Œé€šè¿‡æ£€æŸ¥ngx_exitingã€ngx_terminateã€ngx_quitã€ ngx_reopenè¿™4ä¸ªæ ‡å¿—ä½æ¥å†³å®šåç»­åŠ¨ä½œã€‚\nQ2:workerè¿›ç¨‹çš„æƒŠç¾¤é—®é¢˜ï¼Ÿ å³å¦‚ä½•è§£å†³å¤šä¸ªworkerå­è¿›ç¨‹ç›‘å¬åŒä¸€ç«¯å£å¼•èµ·çš„â€œæƒŠç¾¤â€ç°è±¡çš„?\nåŠ é”ï¼šngx_process_events_and_timersæ–¹æ³•ä¸­è°ƒç”¨äº†ngx_trylock_accept_mutexæ–¹æ³•ã€‚\nnginxè§„å®šäº†åŒä¸€æ—¶åˆ»åªèƒ½æœ‰å”¯ä¸€ä¸€ä¸ªworkerå­è¿›ç¨‹ç›‘å¬Webç«¯å£ï¼Œè¿™æ ·å°±ä¸ä¼šå‘ç”Ÿâ€œæƒŠ ç¾¤â€äº†ï¼Œæ­¤æ—¶æ–°è¿æ¥äº‹ä»¶åªèƒ½å”¤é†’å”¯ä¸€æ­£åœ¨ç›‘å¬ç«¯å£çš„workerå­è¿›ç¨‹ã€‚\nQ3:workerè¿›ç¨‹çš„å‡è¡¡é—®é¢˜ï¼Ÿ å³å¦‚ä½•å‡è¡¡å¤šä¸ªworkerå­è¿›ç¨‹ä¸Šå¤„ç†çš„è¿æ¥æ•°?\nä¸â€œæƒŠç¾¤â€é—®é¢˜çš„è§£å†³æ–¹æ³•ä¸€æ ·ï¼Œåªæœ‰æ‰“å¼€äº†accept_mutexé”ï¼Œæ‰èƒ½å®ç°workerå­è¿›ç¨‹é—´çš„ è´Ÿè½½å‡è¡¡ã€‚\nQ4:masterè¿›ç¨‹ä¸»è¦åŠŸèƒ½ï¼Ÿ masterè¿›ç¨‹ä¸éœ€è¦å¤„ç†ç½‘ç»œäº‹ä»¶ï¼Œå®ƒä¸è´Ÿè´£ä¸šåŠ¡çš„æ‰§è¡Œï¼Œåªä¼šé€šè¿‡ç®¡ç†workerç­‰å­è¿›ç¨‹ æ¥å®ç°é‡å¯æœåŠ¡ã€å¹³æ»‘å‡çº§ã€æ›´æ¢æ—¥å¿—æ–‡ä»¶ã€é…ç½®æ–‡ä»¶å®æ—¶ç”Ÿæ•ˆç­‰åŠŸèƒ½ã€‚\né—®é¢˜æ¢ç´¢ nginxç‰¹ç‚¹ é€‰æ‹©Nginxçš„æ ¸å¿ƒç†ç”±è¿˜æ˜¯å®ƒèƒ½åœ¨æ”¯æŒé«˜å¹¶å‘è¯·æ±‚çš„åŒæ—¶ä¿æŒé«˜æ•ˆçš„æœåŠ¡ã€‚\nä½å†…å­˜æ¶ˆè€— é«˜å¯é æ€§:ä¸€ä¸ªmasterç®¡ç†è¿›ç¨‹ã€å¤šä¸ªworkerå·¥ä½œè¿›ç¨‹çš„è®¾è®¡æ–¹å¼ é«˜æ‰©å±•æ€§:é«˜åº¦æ¨¡å—åŒ–çš„è®¾è®¡ æ›´å¿« äº‹ä»¶å¤„ç† å¼€å‘ä¸€ä¸ªç®€å•çš„HTTPæ¨¡å— todo: å¼€å‘ngx_http_mytest_module\nå‚è€ƒä¾‹å­\nå…¶ä»– vscodeæœ¬åœ°è°ƒè¯• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 { \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;debug nginx\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;cppdbg\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;program\u0026#34;: \u0026#34;${workspaceFolder}/objs/nginx\u0026#34;, \u0026#34;stopAtEntry\u0026#34;: false, \u0026#34;cwd\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34;, \u0026#34;environment\u0026#34;: [], \u0026#34;externalConsole\u0026#34;: false } ] } mkcertåˆ›å»ºè‡ªç­¾åSSLè¯ä¹¦ 1 2 3 mkcert -install # å°† mkcert çš„è®¤è¯æœºæ„å®‰è£…åˆ°æœåŠ¡å™¨ä¸Š mkcert -CAROOT # æŸ¥çœ‹ CA è¯ä¹¦çš„ä½ç½®ï¼Œåœ¨PCä¸Šå®‰è£… rootCA.crt è¯ä¹¦ mkcert www.aaa.com aiPlatform.dev localhost 127.0.0.1 ::1 43.139.87.74 # ç”Ÿæˆè¯ä¹¦ï¼Œé…ç½®åœ¨nginx.confä¸­ nginxå››å±‚è½¬å‘ æºç ç¼–è¯‘æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰‹åŠ¨åŠ è½½streamæ¨¡å—:\n./auto/configure \u0026ndash;with-http_ssl_module \u0026ndash;prefix=/home/github/nginx \u0026ndash;with-stream\nç„¶ååœ¨nginx.confæ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹æ”¯æŒtcpè½¬å‘ï¼Œstream_backendç¨‹åº: 1 2 3 4 5 6 7 8 9 10 11 12 stream { upstream stream_backend { zone tcp_servers 64k; hash $remote_addr; server 127.0.0.1:18000; } server { listen 8000; proxy_pass stream_backend; } } ","date":"2022-11-22T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img1.png","permalink":"https://soli.seekincs.com/2022/11/nginx%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/","title":"nginxå·¥ä½œç¬”è®°"},{"content":"é—®é¢˜æ¢ç´¢ è°ƒåº¦å™¨ è°ƒåº¦å™¨çš„å·¥ä½œæ˜¯åœ¨é€‚å½“çš„æ—¶æœºå°†åˆé€‚çš„åç¨‹åˆ†é…åˆ°åˆé€‚çš„ä½ç½®ï¼Œåœ¨è°ƒåº¦è¿‡ç¨‹ä¸­éœ€è¦ä¿è¯å…¬å¹³å’Œæ•ˆç‡ã€‚\nè°ƒåº¦æ—¶æœº æ ¹æ®è°ƒåº¦æ–¹å¼çš„ä¸åŒï¼Œå°†è°ƒåº¦æ—¶æœºåˆ†ä¸ºä¸»åŠ¨ã€è¢«åŠ¨å’ŒæŠ¢å è°ƒåº¦ã€‚\nä¸»åŠ¨è°ƒåº¦ éœ€è¦å…ˆä»å½“å‰åç¨‹åˆ‡æ¢åˆ°åç¨‹g0ï¼Œå–æ¶ˆGä¸Mä¹‹é—´çš„ç»‘å®šå…³ç³»ï¼Œå°†Gæ”¾å…¥å…¨å±€è¿è¡Œé˜Ÿåˆ—ï¼Œå¹¶è°ƒç”¨scheduleå‡½æ•°å¼€å§‹æ–°ä¸€è½®çš„å¾ªç¯ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 func goschedImpl(gp *g) { status := readgstatus(gp) if status\u0026amp;^_Gscan != _Grunning { dumpgstatus(gp) throw(\u0026#34;bad g status\u0026#34;) } casgstatus(gp, _Grunning, _Grunnable) // å–æ¶ˆGä¸Mä¹‹é—´çš„ç»‘å®šå…³ç³» dropg() lock(\u0026amp;sched.lock) // æŠŠGæ”¾å…¥å…¨å±€è¿è¡Œé˜Ÿåˆ— globrunqput(gp) unlock(\u0026amp;sched.lock) // è¿›å…¥æ–°ä¸€è½®è°ƒåº¦ schedule() } è¢«åŠ¨è°ƒåº¦ å’Œä¸»åŠ¨è°ƒåº¦ç±»ä¼¼çš„æ˜¯ï¼Œè¢«åŠ¨è°ƒåº¦éœ€è¦å…ˆä»å½“å‰åç¨‹åˆ‡æ¢åˆ°åç¨‹g0ï¼Œæ›´æ–°åç¨‹çš„çŠ¶æ€å¹¶è§£ç»‘ä¸Mçš„å…³ç³»ï¼Œé‡æ–°è°ƒåº¦ã€‚ å’Œä¸»åŠ¨è°ƒåº¦ä¸åŒçš„æ˜¯ï¼Œè¢«åŠ¨è°ƒåº¦ä¸ä¼šå°†Gæ”¾å…¥å…¨å±€è¿è¡Œé˜Ÿåˆ—ï¼Œå› ä¸ºå½“å‰Gçš„çŠ¶æ€ä¸æ˜¯_Grunnableè€Œæ˜¯_Gwaitingï¼Œ æ‰€ä»¥ï¼Œè¢«åŠ¨è°ƒåº¦éœ€è¦ä¸€ä¸ªé¢å¤–çš„å”¤é†’æœºåˆ¶ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 func park_m(gp *g) { _g_ := getg() casgstatus(gp, _Grunning, _Gwaiting) dropg() if fn := _g_.m.waitunlockf; fn != nil { ok := fn(gp, _g_.m.waitlock) _g_.m.waitunlockf = nil _g_.m.waitlock = nil if !ok { if trace.enabled { traceGoUnpark(gp, 2) } casgstatus(gp, _Gwaiting, _Grunnable) execute(gp, true) // Schedule it back, never returns. } } schedule() } æŠ¢å è°ƒåº¦ ä¸ºäº†è®©æ¯ä¸ªåç¨‹éƒ½æœ‰æ‰§è¡Œçš„æœºä¼šï¼Œå¹¶ä¸”æœ€å¤§åŒ–åˆ©ç”¨CPUèµ„æºï¼ŒGoè¯­è¨€åœ¨åˆå§‹åŒ–æ—¶ä¼šå¯åŠ¨ä¸€ä¸ªç‰¹æ®Šçš„çº¿ç¨‹æ¥æ‰§è¡Œç³»ç»Ÿç›‘æ§ä»»åŠ¡ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 // proc.retakeå‡½æ•° func retake(now int64) uint32 { n := 0 lock(\u0026amp;allpLock) // éå†æ‰€æœ‰çš„P for i := 0; i \u0026lt; len(allp); i++ { _p_ := allp[i] if _p_ == nil { continue } pd := \u0026amp;_p_.sysmontick s := _p_.status sysretake := false if s == _Prunning || s == _Psyscall { // å¦‚æœGè¿è¡Œæ—¶é—´è¿‡é•¿åˆ™æŠ¢å  t := int64(_p_.schedtick) if int64(pd.schedtick) != t { pd.schedtick = uint32(t) pd.schedwhen = now } else if pd.schedwhen+forcePreemptNS \u0026lt;= now { // è¿ç»­è¿è¡Œè¶…è¿‡10msï¼Œè®¾ç½®æŠ¢å è¯·æ±‚ preemptone(_p_) sysretake = true } } // På¤„äºç³»ç»Ÿè°ƒç”¨ä¹‹ä¸­ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦æŠ¢å  if s == _Psyscall { // å¦‚æœå·²ç»è¶…è¿‡äº†ä¸€ä¸ªç³»ç»Ÿç›‘æ§çš„tick(20us)ï¼Œåˆ™ä»ç³»ç»Ÿè°ƒç”¨ä¸­æŠ¢å P // ...çœç•¥ } } unlock(\u0026amp;allpLock) return uint32(n) } è°ƒåº¦ç­–ç•¥ è°ƒåº¦åç¨‹çš„ä¼˜å…ˆçº§ä¸é¡ºåºå¦‚ä¸‹æ‰€ç¤º:\ngraph LR A[runnext] --\u003e B{nil?}; B -- Yes --\u003e C[p.runq]; C --\u003e D{head=tail?}; D -- Yes ----\u003e F[schet.runq]; F --\u003e G{runqsize=0?}; G -- Yes --\u003e H[ä»å…¶ä»–Pçªƒå–]; H --\u003e J{find?}; J -- Yes ----\u003e K[æ‰¾åˆ°G]; J -- No ----\u003e L[æœªæ‰¾åˆ°G,ä¼‘çœ ]; F -- No ----\u003e I[æ‰¾åˆ°G]; D -- No --\u003e E[æ‰¾åˆ°G]; B -- No ----\u003e W[æ‰¾åˆ°G]; å…¶ä»– ç¼–è¯‘ ç¼–è¯‘è„šæœ¬(all.bash/make.bash)ä¸­æ³¨é‡Šæ‰ï¼Œè·³è¿‡ç¼–è¯‘testï¼Œå› ä¸ºå¤ªæ…¢\nmkdir -p ~/mygo/bin cd ~/mygo/bin ln -sf /usr/local/projs/go/bin/go mygo mygo version mygo run helloworld.go ","date":"2022-11-14T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img6.png","permalink":"https://soli.seekincs.com/2022/11/golang%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/","title":"Golangå·¥ä½œç¬”è®°"},{"content":"wiresharkæ•è·grpcæ¶ˆæ¯ å…·ä½“å‚è€ƒ ","date":"2022-11-14T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img5.png","permalink":"https://soli.seekincs.com/2022/11/grpc-go%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/","title":"gRPC-Goå·¥ä½œç¬”è®°"},{"content":"åŸºç¡€å‘½ä»¤ centos7ç‰ˆæœ¬ cat /etc/redhat-release è§£å‹ tar -zxvf grafana-8.0.6.linux-amd64.tar.gz aliasåˆ«å è§£å†³é‡å¯åaliaså¤±æ•ˆé—®é¢˜ã€‚éç³»ç»Ÿæ–‡ä»¶å°½é‡æ”¾åœ¨homeç›®å½•ä¸‹\nvim ~/.bashrc alias cdhub='cd /home/github' alias cdclash='cd /home/clash' source ~/.bashrc æŸ¥çœ‹é¡¹ç›®ä»£ç è¡Œæ•° yum -y install cloc cloc src æ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹å¤§å° du -hs linuxå¼€å¯swapåˆ†åŒº dd if=/dev/zero of=/swapfile bs=64M count=64 chmod 0600 /swapfile mkswap /swapfile swapon /swapfile swapon -s linuxç”Ÿæˆ32ä½éšæœºä¸² cat /dev/urandom | head -n 10 | md5sum https://www.cnblogs.com/Axianba/p/13131620.html\nå®‰è£…git2.x sudo yum install https://packages.endpointdev.com/rhel/7/os/x86_64/endpoint-repo.x86_64.rpm sudo yum install git git --version git config --global user.name \u0026quot;Your Name\u0026quot; git config --global user.email \u0026quot;email@example.com\u0026quot; ssh-keygen -t rsa -C \u0026quot;your_email@youremail.com\u0026quot; cat /root/.ssh/id_rsa.pub gccå‡çº§åˆ°7.13 sudo yum install centos-release-scl sudo yum install devtoolset-7-gcc* ln -sf /opt/rh/devtoolset-7/root/usr/bin/gcc /usr/bin/gcc ln -sf /opt/rh/devtoolset-7/root/usr/bin/g++ /usr/bin/g++ å®‰è£…cmake3 yum -y install cmake3 sudo ln -s /usr/bin/cmake3 /usr/bin/cmake cmake --version å®‰è£…æŒ‡å®šç‰ˆæœ¬\nwget https://github.com/Kitware/CMake/releases/download/v3.24.0/cmake-3.24.0-linux-x86_64.tar.gz tar -zxvf cmake-3.24.0-linux-x86_64.tar.gz ln -sf /usr/local/cmake-3.24.0-linux-x86_64/bin/cmake /usr/bin/cmake å®‰è£…mysql-8.0.24 cmakeå‘½ä»¤\nmkdir build \u0026amp;\u0026amp; cd build cmake .. -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/usr/local/mysql/data -DCMAKE_C_COMPILER=/usr/bin/gcc -DCMAKE_CXX_COMPILER=/usr/bin/g++ -DSYSCONFDIR=/etc -DWITH_BOOST=/usr/local/boost -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DENABLED_LOCAL_INFILE=ON -DWITH_INNODB_MEMCACHED=ON -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_FEDERATED_STORAGE_ENGINE=1 -DWITH_BLACKHOLE_STORAGE_ENGINE=1 -DWITH_ARCHIVE_STORAGE_ENGINE=1 -DWITHOUT_EXAMPLE_STORAGE_ENGINE=1 -DWITH_PERFSCHEMA_STORAGE_ENGINE=1 -DFORCE_INSOURCE_BUILD=1 -DMYSQL_TCP_PORT=3306 ç¼–è¯‘ï¼Œå®‰è£…ï¼Œåˆå§‹åŒ–ï¼Œå¯åŠ¨ï¼š\ngroupadd mysql useradd -r -g mysql -s /bin/false mysql make\u0026amp;\u0026amp;make install chown -R mysql:mysql /usr/local/mysql/ /usr/local/mysql/bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data /usr/local/mysql/bin/mysqld_safe --defaults-file=/usr/local/mysql/etc/my.cnf ç»Ÿè®¡80ç«¯å£è¿æ¥æ•° netstat -nat | grep -i \u0026quot;80\u0026quot; | wc -l netstat -nat | grep -i \u0026quot;18000\u0026quot; | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' # æŸ¥çœ‹TCPè¿æ¥çŠ¶æ€ ç£ç›˜å æ»¡æ’æŸ¥ df -hl du -s /* | sort -nr |head # é€‰å‡ºæ’åœ¨å‰é¢çš„10ä¸ªï¼Œheadæ”¹æˆtailåˆ™æ˜¯åé¢10ä¸ª du -sh /* | sort -nr # åŠ äº†hæ’åºé”™ä¹± du -sh /home/* | sort -nr å†…å­˜å ç”¨é«˜æ’æŸ¥ top -o %MEM # æŒ‰å†…å­˜å ç”¨æ’åº vmstat 2 # æ¯éš”2ç§’å±•ç¤ºå†…å­˜å ç”¨æƒ…å†µ kill -9 `ps -ef| grep tail |awk '{print $2}' ` cat /proc/24573/status # æŸ¥çœ‹è¿›ç¨‹å†…å­˜ å¥åº·æ£€æŸ¥è„šæœ¬health-check-script å¥åº·æ£€æŸ¥è„šæœ¬\nå…·ä½“ä½¿ç”¨ä¾‹å­\ncentos7å®‰è£…clash url1\nurl2\nå®‰è£…prometheuså’Œgrafana åœºæ™¯: ç¼–å†™Dockerfile\ngrafana8.0.6å®˜ç½‘ä¸‹è½½\nFROM quay.io/prometheus/prometheus USER root RUN echo 'Asia/Shanghai' \u0026gt;/etc/timezone ADD prometheus.yml /etc/prometheus/ æœåŠ¡å¯åŠ¨è„šæœ¬ #!/bin/sh mainpid=$(lsof -i:8686|grep 'LISTEN'|awk '{print $2}') echo $mainpid if [ $mainpid \u0026gt; 0 ];then echo \u0026quot;main process id:$mainpid\u0026quot; kill -9 $mainpid if [ $? -eq 0 ];then echo \u0026quot;kill $mainpid success\u0026quot; go run main.go else echo \u0026quot;kill $mainpid fail\u0026quot; fi else go run main.go fi mysqlç›¸å…³ dockerå¯åŠ¨mysql5.7 docker run --name mysql -p 3306:3306 -v /home/github/utopia/my.cnf:/etc/my.cnf -v /home/mysql/data:/var/lib/mysql/data -e MYSQL_ROOT_PASSWORD=rootroot -d mysql:5.7 docker-mysqlå¯¼è¡¨ docker exec -i mysql mysql -h 127.0.0.1 -P 3306 -u root -p'rootroot' \u0026lt; /home/github/ranger/dao/gozero_sys_dept.sql innodb_spaceå·¥å…·è°ƒè¯• innodb_space -s ibdata1 -T mask/t_mask -p 3 page-dump æŠ“åŒ… å¸¸ç”¨æŠ“åŒ…å·¥å…·ï¼š Charlesã€wiresharksã€http debugã€‚ éƒ¨åˆ†è½¯ä»¶(eg: WPS windowsç«¯)åªèƒ½æŠ“åˆ°æå°‘é‡çš„httpsè¯·æ±‚ã€‚ è§£å†³åŠæ³•ï¼šåŸºäºproxifier+charlesæŠ“åŒ…æ•è·æ‰€æœ‰è¯·æ±‚ã€‚\n","date":"2022-11-14T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img7.png","permalink":"https://soli.seekincs.com/2022/11/linux%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E7%AC%94%E8%AE%B0/","title":"linuxå¼€å‘å¸¸ç”¨ç¬”è®°"},{"content":"é—®é¢˜æ¢ç´¢ ä¸€æ¡SQLçš„ç”Ÿå‘½å‘¨æœŸ å‚è€ƒæ–‡ç« \nmysqlæ’ä»¶åŒ–æ¶æ„ mysql8.0å–æ¶ˆæŸ¥è¯¢ç¼“å­˜ å®˜æ–¹è¯´æ˜\nç½‘ç»œIOæ¨¡å‹ å‚è€ƒæ–‡ç« \nå…¶ä»– mysql8.0.24æºç ç¼–è¯‘å®‰è£… ä¸»è¦æ˜¯å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œæ“ä½œè¿‡ç¨‹ä¸­æ ¹æ®æŠ¥é”™è¿›è¡Œfixï¼Œç‰¹åˆ«æ˜¯ä¿®æ”¹my.cnfé…ç½®æ–‡ä»¶ã€‚\nç¼–è¯‘å®‰è£…é—®é¢˜ OpenSSL ç‰ˆæœ¬ä¸å…¼å®¹\nä¸å…¼å®¹1.1ç‰ˆæœ¬ï¼Œéœ€è¦openssl1.0.2ï¼Œé€šè¿‡yum install openssl-develã€‚\nç£ç›˜ç©ºé—´ä¸è¶³\n60gç£ç›˜æ»¡äº†ï¼Œå¯¼è‡´make ç»ˆæ­¢ï¼Œ/dataç›®å½•åˆ æ‰å³å¯ã€‚\nfatal error: error writing to /tmp/ccFtecZv.s: No space left on device å†…å­˜ä¸è¶³\néœ€è¦å¼€å¯swapåˆ†åŒº g++: internal compiler error: Killed (program cc1plus) å¤ªåƒå†…å­˜ï¼Œmakeå·¨æ…¢\næ²¡æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ\u0026hellip; ç¼ºå°‘ä¾èµ–ç»„ä»¶\nå¯èƒ½æ˜¯ç¼ºå°‘ncurses-devel yum install ncurses-devel libaio bison zlib-devel openssl openssl-devel patch mysqldå¯åŠ¨é—®é¢˜ ç£ç›˜ç©ºé—´ä¸è¶³ æ³¨æ„my.cnfé…ç½®æ–‡ä»¶ï¼Œç‰¹åˆ«innodbå‚æ•°é…ç½®ï¼Œå¯èƒ½å› ç³»ç»Ÿå†…å­˜æˆ–ç£ç›˜å®¹é‡å¯¼è‡´å¯åŠ¨å¤±è´¥\næŸ¥çœ‹ç³»ç»Ÿç£ç›˜: df -h\n[InnoDB] Error number 28 means \u0026lsquo;No space left on device\u0026rsquo;\nvscodeæœ¬åœ°è°ƒè¯•mysql8.0.24 å…ˆåœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n./mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data launch.jsoné…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 { \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;debug mysql\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;cppdbg\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;program\u0026#34;: \u0026#34;/usr/local/mysql/bin/mysqld\u0026#34;, \u0026#34;args\u0026#34;: [\u0026#34;--defaults-file=/usr/local/mysql/etc/my.cnf\u0026#34;], \u0026#34;stopAtEntry\u0026#34;: false, \u0026#34;cwd\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34;, \u0026#34;environment\u0026#34;: [], \u0026#34;externalConsole\u0026#34;: false } ] } æºç ç»“æ„ å®‰è£…treeå·¥å…·ï¼Œæ‰§è¡Œtree -d -L 1å‘½ä»¤ï¼š\n|-- build |-- client |-- cmake |-- components |-- Docs |-- doxygen_resources |-- extra |-- include |-- libbinlogevents |-- libbinlogstandalone |-- libmysql |-- libservices |-- man |-- mysql-test |-- mysys |-- packaging |-- plugin |-- router |-- scripts |-- share |-- source_downloads |-- sql |-- sql-common |-- storage |-- strings |-- support-files |-- testclients |-- unittest |-- utilities `-- vio è¯­é›€ä»£ç ç”»æ—¶åºå›¾ï¼š https://www.bookstack.cn/read/yuque/34.md\nMysqlçº¿ç¨‹çš„åŸºæœ¬è®¾ç½® mysql\u0026gt; show variables like 'thread%'; +-------------------+---------------------------+ | Variable_name | Value | +-------------------+---------------------------+ | thread_cache_size | 1536 | | thread_handling | one-thread-per-connection | | thread_stack | 524288 | +-------------------+---------------------------+ 3 rows in set (0.05 sec) mysql\u0026gt; show global status like 'Thread%'; +-------------------+-------+ | Variable_name | Value | +-------------------+-------+ | Threads_cached | 0 | | Threads_connected | 1 | | Threads_created | 1 | | Threads_running | 1 | +-------------------+-------+ 4 rows in set (0.07 sec) è¿œç¨‹è¿æ¥ rootå¿˜è®°å¯†ç \n--- mysqldæ¨¡å—ä¸‹å¢åŠ skip-grant-tablesé…ç½®,å…å¯†ç™»å½•åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š update user set authentication_string = '' where user ='root'; --- æ³¨é‡Šæ‰skip-grant-tablesé…ç½®,é‡æ–°ç™»å½•ï¼Œè®¾ç½®æ–°å¯†ç ï¼š ALTER USER 'root'@'localhost' IDENTIFIED BY 'root123456'; å…è®¸å¤–éƒ¨è®¿é—®\nuse mysql; update user set host='%' where user ='root'; FLUSH PRIVILEGES; æµ‹è¯•mermaid sequenceDiagram participant Alice participant Bob Alice-\u003e\u003eJohn: Hello John, how are you? loop Healthcheck John-\u003eJohn: Fight against hypochondria end Note right of John: Rational thoughts prevail... John--\u003eAlice: Great! John-\u003eBob: How about you? Bob--\u003eJohn: Jolly good! ","date":"2022-11-14T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img2.png","permalink":"https://soli.seekincs.com/2022/11/mysql-source-code-learning/","title":"mysql source code learning"},{"content":"redis+luaå®ç°åˆ†å¸ƒå¼é™æµ äº‹ä»¶å¤„ç† å…¶ä»– vscodeæœ¬åœ°è°ƒè¯• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 { \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;debug redis\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;cppdbg\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;program\u0026#34;: \u0026#34;${workspaceFolder}/src/redis-server\u0026#34;, \u0026#34;args\u0026#34;: [\u0026#34;redis.conf\u0026#34;], \u0026#34;stopAtEntry\u0026#34;: false, \u0026#34;cwd\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34;, \u0026#34;environment\u0026#34;: [], \u0026#34;externalConsole\u0026#34;: false } ] } redis-benchmarkå‹æµ‹ 1 2 3 4 5 cd /usr/local/projs/redis/src \u0026amp;\u0026amp; ./redis-benchmark -h ./redis-benchmark -t set -n 1000000 -r 100000000 47496.91 requests per second ./redis-benchmark -t set -n 1000000 -r 100000000 -P 16 291290.41 requests per second æŸ¥çœ‹RDBå¿«ç…§æ–‡ä»¶ rdb -c memory dump.rdb \u0026gt; dump_rdb.csv\nå…¶ä¸­ï¼šsize_in_bytes å†…å­˜çš„å¤§å°ï¼Œç”±æ­¤å¯ä»¥æŸ¥è¯¢å†…å­˜æœ€é«˜çš„key\nredis5.0æ­å»ºä¼ªåˆ†å¸ƒå¼é›†ç¾¤ å…·ä½“é…ç½®å‚è€ƒcommit\n/home/github/redis/src/redis-cli --cluster create --cluster-replicas 1 10.0.12.2:7001 10.0.12.2:7002 10.0.12.2:7003 10.0.12.2:7004 10.0.12.2:7005 10.0.12.2:7006 ./src/redis-cli -h 10.0.12.2 -p 7001 -c cluser nodes cluser info å‚è€ƒèµ„æ–™ Redisä¸­æ–‡ç½‘ ç”¨goå®ç°redisæœåŠ¡å™¨ ","date":"2022-11-14T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img1.png","permalink":"https://soli.seekincs.com/2022/11/redis%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/","title":"rediså·¥ä½œç¬”è®°"},{"content":"EMQXå®‰è£…éƒ¨ç½² EMQX æ˜¯ä¸€æ¬¾å¤§è§„æ¨¡å¯å¼¹æ€§ä¼¸ç¼©çš„äº‘åŸç”Ÿåˆ†å¸ƒå¼ç‰©è”ç½‘ MQTT æ¶ˆæ¯æœåŠ¡å™¨ğŸ˜‚ã€‚\nDockerå•èŠ‚ç‚¹å¤šå®ä¾‹ åŸºäºdocker-compose+haproxyæ­å»ºä¼ªåˆ†å¸ƒå¼é›†ç¾¤ï¼š\nå¯åŠ¨ï¼šdocker-compose -f docker-compose-emqx-cluster.yaml up\nå…³é—­ï¼šdocker-compose -f docker-compose-emqx-cluster.yaml down\nDockerå¤šèŠ‚ç‚¹ ä¿®æ”¹emqx.confé…ç½®æ–‡ä»¶(è¿™é‡Œé€‰æ‹©staticæ–¹å¼)ï¼Œé›†ç¾¤èŠ‚ç‚¹å¼€æ”¾æŸäº›ç«¯å£ï¼š\ncluster.discovery = static cluster.static.seeds = emqx@120.92.94.79,emqx@120.92.88.242 rpc.port_discovery = manual rpc.tcp_server_port = 5369 ä¸¤ä¸ªé›†ç¾¤èŠ‚ç‚¹åˆ†åˆ«æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\ndocker run -d --name emqx_cluster -v /emqx.conf:/opt/emqx/etc/emqx.conf -v /emqx_auth_mysql.conf:/opt/emqx/etc/plugins/emqx_auth_mysql.conf -v /loaded_plugins:/opt/emqx/data/loaded_plugins --env EMQX_LOG__TO=both --env EMQX_HOST=120.92.94.79 -p 1883:1883 -p 8081:8081 -p 8083:8083 -p 8084:8084 -p 8883:8883 -p 18083:18083 -p 4370:4370 -p 5370:5370 -p 4369:4369 -p 5369:5369 -p 6369:6369 -p 6370:6370 emqx/emqx:4.4.4 k8sé›†ç¾¤ è§å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼Œä¼ é€é—¨\nå®‰å…¨ å®‰å…¨ä¸»è¦åŒ…æ‹¬æœåŠ¡ç«¯è®¿é—®æ§åˆ¶å’Œå®¢æˆ·ç«¯SDKå®‰å…¨ï¼Œå…·ä½“å¦‚ä¸‹ï¼š\næœåŠ¡ç«¯å¯ç”¨emqx_auth_mysqlæ’ä»¶å®ç°è®¤è¯å’Œæˆæƒã€‚\nå®¢æˆ·ç«¯SDKå¼•å…¥çš„ç¬¬ä¸‰æ–¹åº“ï¼Œ è¦èµ°ä¸­å°ç»Ÿä¸€çš„ä¸‰æ–¹åº“æŠ¥å¤‡ã€å®¡æŸ¥ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ¼æ´æˆ–å…¶ä»–é£é™©ã€‚\nå®¢æˆ·ç«¯SDK ä¸€äº›SDKä¸æ”¯æŒmqtt5.0ï¼Œå…¶å½±å“æ˜¯pub/subæ“ä½œæ— æ³•æ‹¿åˆ°åŸå› ç ã€‚ä¸€äº›SDKä¸æ”¯æŒæ–­çº¿é‡è¿ã€‚\næ³¨æ„ç‚¹ï¼šclient_idå°½é‡ä¸å¡«(æˆ–è€…é‡è¿æ—¶é‡‡ç”¨ç¬¬ä¸€æ¬¡è¿æ¥åè¿”å›çš„client_id)ï¼Œé¿å…client_idé‡å¤å¯¼è‡´ä¼šè¯äº’è¸¢ã€‚\nGoç‰ˆæœ¬å»ºè®®é€‰æ‹©paho.golangï¼Œå› ä¸ºæ”¯æŒ5.0åè®®ã€‚\nC++ç‰ˆæœ¬å»ºè®®é€‰æ‹©paho.mqtt.cppï¼Œä¹Ÿå¯ä»¥å‚è€ƒæˆ‘å†™çš„ä¸€ä¸ªåŸºäºvcpkg+cmakeçš„demo\nJSç‰ˆæœ¬å»ºè®®é€‰æ‹©ws-mqtt\nå‹åŠ›éªŒè¯ å‹æµ‹å·¥å…·\nç¡¬ä»¶é…ç½®ï¼šä¸€å°è…¾è®¯äº‘æœåŠ¡å™¨2c4gã€‚\nä¸€ä¸ªmasterèŠ‚ç‚¹çš„k8sä¸Šè¿è¡Œemqx 6ä¸ªpodï¼Œç›®å‰åªèƒ½æ”¯æŒ27322ä¸ªè®¢é˜…ç«¯ï¼ŒæœåŠ¡å™¨CPU 100%ã€‚\né‡åˆ°çš„é—®é¢˜ client(4): EXIT for {shutdown,eaddrinuse}\nè§£å†³æ–¹æ³•ï¼š\næ‰©å¤§ç«¯å£æ•°é‡\næé«˜ç«¯å£ä½¿ç”¨ç‡\n","date":"2022-11-13T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img1.png","permalink":"https://soli.seekincs.com/2022/11/mqtt-broker-in-action/","title":"MQTT Broker in Action"},{"content":"\nèƒŒæ™¯ å½“éœ€è¦æä¾›ä¸€ç§æ–°èƒ½åŠ›ï¼Œè€ƒè™‘åˆ°æˆæœ¬é—®é¢˜ï¼Œæˆ‘ä»¬å¾€å¾€ä¸ä¼šä»0åˆ°1å¼€å‘ä¸€ä¸ªæœåŠ¡å™¨ï¼Œè€Œæ˜¯å…ˆåœ¨å¼€æºäº§å“ä¸­é€‰å‹å¯¹æ¯”ï¼Œçœ‹æ˜¯å¦å·²æœ‰èƒ½æ»¡è¶³è‡ªèº«éœ€æ±‚çš„å¼€æºäº§å“(ä¸é‡å¤é€ è½®å­çš„åŸåˆ™)ã€‚å› ä¸ºå¯¹å¼€æºæœåŠ¡å™¨çš„ä¸ç†Ÿæ‚‰ï¼Œéƒ¨ç½²è¿‡ç¨‹ä¸­ä¼šè¸©è¿™æ ·é‚£æ ·çš„å‘ï¼Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œå¦‚ä½•å¿«é€Ÿéƒ¨ç½²å¹¶åº”ç”¨äºå®é™…ä¸šåŠ¡åœºæ™¯å‘¢ï¼Ÿ\néšä¾¿æä¸€ä¸‹ï¼Œç§æœ‰åŒ–éƒ¨ç½²çš„åŸå› ä¸»è¦æ˜¯è€ƒè™‘åˆ°æ•°æ®å®‰å…¨ï¼Œå®‰å…¨æ— å°äº‹ï¼Œå®‰å…¨å¤§äºä¸€åˆ‡ å‡†å¤‡å·¥ä½œ äº‘ä¸»æœº(å†…éƒ¨å®‰è£…äº†dockerã€docker-composeã€é˜²ç«å¢™å¼€æ”¾æŒ‡å®šç«¯å£) ä¸ªäººç”µè„‘(å†…éƒ¨å®‰è£…äº†docker-desktopã€xshellã€vscodeã€golang) ä»”ç»†çœ‹å®˜æ–¹æ–‡æ¡£ä»¥åŠå®˜æ–¹å¼€æºç¤¾åŒº æ³¨æ„ï¼šemqxæ˜¯4.4.4ç‰ˆæœ¬\néƒ¨ç½² é¢„æœŸæ•ˆæœ (é…ç½®æ–‡ä»¶ã€æ—¥å¿—)æ–‡ä»¶/ç›®å½•æŒ‚è½½åˆ°æœ¬åœ°ç£ç›˜\nç›‘æ§ã€å‘Šè­¦ã€å¯è§†åŒ–ç­‰åŠŸèƒ½\nåè®®æ¥å…¥ã€é›†ç¾¤éƒ¨ç½²ã€æ¥å…¥å®‰å…¨ å…·ä½“æµç¨‹ ä¸ªäººç”µè„‘ -\u0026gt; äº‘ä¸»æœº\nå•æœºç‰ˆ -\u0026gt; é›†ç¾¤ç‰ˆ(è´Ÿè½½å‡è¡¡) å¯åŠ¨ ä»”ç»†æ£€æŸ¥docker-compose-emqx-cluster.yaml é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™ä¼šå¯åŠ¨å¤±è´¥\nå¯åŠ¨å‘½ä»¤ï¼š docker-compose -f docker-compose-emqx-cluster.yaml up \u0026amp; é€€å‡ºå‘½ä»¤ï¼š docker-compose -f docker-compose-emqx-cluster.yaml down æ¥å…¥å®‰å…¨ æœåŠ¡ç«¯è®¿é—®æ§åˆ¶ åœ¨loaded_pluginsé…ç½®æ–‡ä»¶ä¸­å¯ç”¨emqx_auth_mysqlæ’ä»¶ã€‚ 1 2 3 4 5 6 7 8 9 {emqx_management,true}. {emqx_dashboard,true}. {emqx_modules,false}. {emqx_recon,true}. {emqx_retainer,true}. {emqx_telemetry,true}. {emqx_rule_engine,true}. {emqx_bridge_mqtt,false}. {emqx_auth_mysql,true}. emqxé»˜è®¤æ˜¯ä¸è®¾ç½®æƒé™ï¼Œéœ€è¦ä¿®æ”¹acl.confå¯ç”¨é‰´æƒã€‚ 1 2 3 {allow, {user, \u0026#34;dashboard\u0026#34;}, subscribe, [\u0026#34;$SYS/#\u0026#34;]}. {allow, {ipaddr, \u0026#34;127.0.0.1\u0026#34;}, pubsub, [\u0026#34;$SYS/#\u0026#34;, \u0026#34;#\u0026#34;]}. {deny, all, subscribe, [\u0026#34;$SYS/#\u0026#34;, {eq, \u0026#34;#\u0026#34;}]}. ä¿®æ”¹emqx_auth_mysql.confé…ç½®æ–‡ä»¶ï¼šä¿®æ”¹æ•°æ®åº“å®ä¾‹ï¼Œåˆ›å»ºè®¤è¯è¡¨å’Œæˆæƒè¡¨ã€‚\nç”¨æˆ·å/å¯†ç è®¤è¯é˜²æ­¢éæ³•å®¢æˆ·ç«¯è¿æ¥ã€‚ 1 2 3 4 5 6 7 8 9 10 CREATE TABLE `mqtt_user` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `username` varchar(100) DEFAULT NULL, `password` varchar(100) DEFAULT NULL, `salt` varchar(35) DEFAULT NULL, `is_superuser` tinyint(1) DEFAULT \u0026#39;0\u0026#39;, `created` datetime DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `mqtt_username` (`username`) ) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 å¯¹ MQTT å®¢æˆ·ç«¯çš„å‘å¸ƒå’Œè®¢é˜…æ“ä½œè¿›è¡Œæƒé™æ§åˆ¶ã€‚æ§åˆ¶å“ªäº›å®¢æˆ·ç«¯å¯ä»¥å‘å¸ƒæˆ–è€…è®¢é˜…å“ªäº›MQTTä¸»é¢˜ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 CREATE TABLE `mqtt_acl` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `allow` int(1) DEFAULT \u0026#39;1\u0026#39; COMMENT \u0026#39;0: deny, 1: allow\u0026#39;, `ipaddr` varchar(60) DEFAULT NULL COMMENT \u0026#39;IpAddress\u0026#39;, `username` varchar(100) DEFAULT NULL COMMENT \u0026#39;Username\u0026#39;, `clientid` varchar(100) DEFAULT NULL COMMENT \u0026#39;ClientId\u0026#39;, `access` int(2) NOT NULL COMMENT \u0026#39;1: subscribe, 2: publish, 3: pubsub\u0026#39;, `topic` varchar(100) NOT NULL DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;Topic Filter\u0026#39;, PRIMARY KEY (`id`), KEY `ipaddr` (`ipaddr`), KEY `username` (`username`), KEY `clientid` (`clientid`) ) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8mb4 å®¢æˆ·ç«¯SDKå®‰å…¨ SDKå¼•å…¥äº†ç¬¬ä¸‰æ–¹åº“ï¼Œ è¦èµ°ä¸­å°ç»Ÿä¸€çš„ä¸‰æ–¹åº“æŠ¥å¤‡ã€å®¡æŸ¥ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ¼æ´æˆ–å…¶ä»–é£é™© ã€‚ é›†ç¾¤éƒ¨ç½² å®é™…ä¸šåŠ¡åœºæ™¯å¯èƒ½å¯¹é«˜æ€§èƒ½ã€é«˜å¯ç”¨æœ‰ç€ä¸€å®šè¦æ±‚ã€‚è¿™é‡Œä»¥ä¼ªåˆ†å¸ƒå¼é›†ç¾¤ä¸ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 version: \u0026#39;3.9\u0026#39; x-default-emqx: \u0026amp;default-emqx image: emqx/emqx:4.4.4 env_file: - conf.cluster.env healthcheck: test: [\u0026#34;CMD\u0026#34;, \u0026#34;/opt/emqx/bin/emqx_ctl\u0026#34;, \u0026#34;status\u0026#34;] interval: 5s timeout: 25s retries: 5 services: haproxy: container_name: haproxy image: haproxy:2.4 privileged: true depends_on: - emqx1 - emqx2 volumes: - ./haproxy/haproxy.cfg:/usr/local/etc/haproxy/haproxy.cfg - ./certs_ha/certs:/usr/local/etc/haproxy/certs ports: - \u0026#34;18083:18083\u0026#34; - \u0026#34;1883:1883\u0026#34; # - \u0026#34;8883:8883\u0026#34; - \u0026#34;8083:8083\u0026#34; # - \u0026#34;8084:8084\u0026#34; - \u0026#34;9090:9090\u0026#34; - \u0026#34;8081:8081\u0026#34; networks: - emqx_bridge working_dir: /usr/local/etc/haproxy command: - bash - -c - | set -x cat /usr/local/etc/haproxy/certs/cert.pem /usr/local/etc/haproxy/certs/key.pem \u0026gt; /tmp/emqx.pem haproxy -f /usr/local/etc/haproxy/haproxy.cfg emqx1: \u0026lt;\u0026lt;: *default-emqx container_name: node1.emqx.io environment: - \u0026#34;EMQX_HOST=node1.emqx.io\u0026#34; ports: - \u0026#34;18081:18083\u0026#34; - \u0026#34;8881:8083\u0026#34; - \u0026#34;1882:1883\u0026#34; - \u0026#34;18087:8081\u0026#34; networks: emqx_bridge: aliases: - node1.emqx.io volumes: - ./dockeremqx/emqx.conf:/opt/emqx/etc/emqx.conf - ./dockeremqx/acl.conf:/opt/emqx/etc/acl.conf - ./dockeremqx/emqx_auth_mysql.conf:/opt/emqx/etc/plugins/emqx_auth_mysql.conf - ./dockeremqx/loaded_plugins:/opt/emqx/data/loaded_plugins - ./dockeremqx/emqx1_log/log:/opt/emqx/log emqx2: \u0026lt;\u0026lt;: *default-emqx container_name: node2.emqx.io environment: - \u0026#34;EMQX_HOST=node2.emqx.io\u0026#34; ports: - \u0026#34;18082:18083\u0026#34; - \u0026#34;8882:8083\u0026#34; - \u0026#34;1881:1883\u0026#34; - \u0026#34;18088:8081\u0026#34; networks: emqx_bridge: aliases: - node2.emqx.io volumes: - ./dockeremqx/emqx.conf:/opt/emqx/etc/emqx.conf - ./dockeremqx/acl.conf:/opt/emqx/etc/acl.conf - ./dockeremqx/emqx_auth_mysql.conf:/opt/emqx/etc/plugins/emqx_auth_mysql.conf - ./dockeremqx/loaded_plugins:/opt/emqx/data/loaded_plugins - ./dockeremqx/emqx2_log/log:/opt/emqx/log networks: emqx_bridge: driver: bridge name: emqx_bridge # ipam: # driver: default # config: # - subnet: 172.100.239.0/24 # gateway: 172.100.239.1 åè®®æ¥å…¥ åº”ç”¨å±‚åè®®åŒ…æ‹¬mqttã€websocketã€httpã€‚è´Ÿè½½å‡è¡¡å™¨æ–¹é¢çš„é…ç½®éå¸¸å…³é”®ï¼Œä¸‹é¢ä»¥haproxyä¸ºä¾‹(æ ¸å¿ƒé…ç½®)ï¼š\nç²˜æ€§ä¼šè¯æ˜¯åœ¨haproxyä¸­é…ç½®çš„ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 defaults log global mode http option httplog # Replace 1024000 with deployment connections maxconn 50000 timeout connect 30000 timeout client 600s timeout server 600s timeout tunnel 1h timeout client-fin 30s timeout http-keep-alive 5s timeout http-request 5s frontend emqx_tcp mode tcp option tcplog bind *:1883 # Reject connections that have an invalid MQTT packet # tcp-request content reject unless { req.payload(0,0), mqtt_is_valid } default_backend emqx_tcp_back frontend emqx_ws mode tcp option httplog bind *:8083 acl host_ws hdr_beg(Host) -i ws. acl hdr_connection_upgrade hdr(Connection) -i upgrade acl hdr_upgrade_websocket hdr(Upgrade) -i websocket use_backend emqx_ws_back if hdr_connection_upgrade hdr_upgrade_websocket default_backend emqx_ws_back backend emqx_tcp_back mode tcp stick on req.payload(0,0),mqtt_field_value(connect,client_identifier) server emqx-1 node1.emqx.io:1883 check-send-proxy send-proxy-v2 server emqx-2 node2.emqx.io:1883 check-send-proxy send-proxy-v2 backend emqx_ws_back mode http balance roundrobin acl hdr_connection_upgrade hdr(Connection) -i upgrade acl hdr_upgrade_websocket hdr(Upgrade) -i websocket acl hdr_websocket_key hdr_cnt(Sec-WebSocket-Key) eq 1 acl hdr_websocket_version hdr_cnt(Sec-WebSocket-Version) eq 1 server emqx-1 node1.emqx.io:8083 server emqx-2 node2.emqx.io:8083 æµ‹è¯• åŠŸèƒ½æµ‹è¯• ç›®æ ‡ï¼šè¿æ¥ã€å‘å¸ƒã€è®¢é˜…ç­‰åŠŸèƒ½ç¬¦åˆé¢„æœŸã€‚\nEMQXæ˜¯å¦æ­£åœ¨è¿è¡Œçš„åˆ¤æ–­æ–¹æ³•ï¼šæ­£å¸¸è¿›å…¥ç®¡ç†åå°ç•Œé¢ã€æ­£å¸¸ç›‘å¬æŸäº›æŒ‡å®šç«¯å£ã€‚\nè¿è¡ŒæŒ‡å®šè¯­è¨€çš„å®¢æˆ·ç«¯SDKæ¥è¿›è¡Œå…³é”®åŠŸèƒ½æµ‹è¯•ï¼Œæ¯”å¦‚golangç‰ˆæœ¬çš„SDK paho.golang ï¼ŒJSç‰ˆæœ¬çš„SDK mqtt-client-WebSocket ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å®˜æ–¹æ¨èçš„å¯è§†åŒ–å·¥å…·æ¥æµ‹è¯•ã€‚ æµ‹è¯•æ–¹æ³• æµ‹è¯•ç‚¹ æœŸæœ›ç»“æœ å…·ä½“è¯´æ˜ å®¢æˆ·ç«¯æ–­çº¿é‡è¿ emqxé‡å¯åï¼Œå®¢æˆ·ç«¯è‡ªåŠ¨é‡è¿ å–å†³äºå®¢æˆ·ç«¯SDKæ˜¯å¦å®ç°äº†å¿ƒè·³é‡è¿ æ¶ˆæ¯ä¸‹å‘æˆåŠŸç‡ æ­£å¸¸æƒ…å†µä¸‹ï¼ŒQoS 1æŠ¥æ–‡ä¸ä¼šä¸¢å¤±æ¶ˆæ¯ Brokeræä¾›3ç§QoSï¼Œé€šå¸¸é€‰æ‹©QoS 1æŠ¥æ–‡(è‡³å°‘é€è¾¾ä¸€æ¬¡)æ¥å…¼é¡¾ååé‡å’Œå‘å¸ƒè´¨é‡ã€‚ æ¶ˆæ¯çŠ¶æ€ç  æ¯æ¬¡æ“ä½œéƒ½èƒ½æ‹¿åˆ°å®æ—¶ä¸”æ­£ç¡®çš„çŠ¶æ€ç  çŠ¶æ€ç æ˜¯MQTT 5.0æ–°ç‰¹æ€§ï¼Œå®¢æˆ·ç«¯SDKéœ€è¦æ”¯æŒ5.0åè®® æ€§èƒ½æµ‹è¯• ç›®æ ‡ï¼šç¡®è®¤æ˜¯å¦ä¸å®˜æ–¹å®£ç§°çš„æ€§èƒ½æ¥è¿‘(æœºå™¨ç¡¬ä»¶æ¡ä»¶ç›¸åŒæƒ…å†µä¸‹)ï¼Œæå‰æš´éœ²å¯èƒ½å­˜åœ¨çš„BUG æµ‹è¯•æ–¹æ³• ä¸€èˆ¬å®˜æ–¹éƒ½ä¼šæä¾›é…å¥—çš„å‹æµ‹å·¥å…·è„šæœ¬ï¼Œæ¯”å¦‚emqtt-benchå¼€æºé¡¹ç›®ï¼Œå°†å…¶è¿è¡Œåœ¨äº‘ä¸»æœºï¼Œå‹æµ‹æ•ˆæœæœ€å¥½ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“æ—¶å»¶ã€‚ 1 ./emqtt_bench sub -t bench -h ${ip} -p 1883 -c 1000 -i 10 -q 1 -u ${username}-P ${password} å‹æµ‹æ³¨æ„äº‹é¡¹ å‹æµ‹å®¢æˆ·ç«¯è¢«é™åˆ¶ï¼šulimitå‘½ä»¤ä¿®æ”¹è¿›ç¨‹æœ€å¤§è¿æ¥æ•°é™åˆ¶ï¼Œå¦åˆ™ä¼šå‹æµ‹ä¸å‡†ï¼Œæœ€å¤§å¹¶å‘è¿æ¥æ•°å¡åœ¨1007ä¸Šä¸å»ã€‚\nå‘å¸ƒç«¯å‘é€æ¶ˆæ¯é€Ÿç‡è¿‡å¿«ï¼š max_mqueue_lenå‚æ•°é»˜è®¤ä¸º1000ï¼Œé˜Ÿåˆ—æ»¡ä¼šæ¶ˆæ¯å‘é€å¤±è´¥ è´Ÿè½½å‡è¡¡å™¨maxconnè®¾ç½®è¿‡å°ï¼šhaproxyçš„maxconné»˜è®¤å€¼æ˜¯1000ï¼Œéœ€è¦è°ƒå¤§ä¸º50000\næ€»ç»“ æ­å»ºå¼€æºæœåŠ¡å™¨ï¼Œéœ€è¦å®ç°åè®®æ¥å…¥ã€é›†ç¾¤éƒ¨ç½²ã€æ¥å…¥å®‰å…¨ç­‰æ ¸å¿ƒåŠŸèƒ½æ¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼Œæœ€ç»ˆç›®çš„æ˜¯ä¸ºä¸šåŠ¡å¸¦æ¥ä¸€å®šçš„ä»·å€¼ã€‚\n","date":"2022-10-30T00:00:00Z","image":"https://someblogs.oss-cn-shenzhen.aliyuncs.com/thumb/img1.png","permalink":"https://soli.seekincs.com/2022/10/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2%E5%BC%80%E6%BA%90%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"å¦‚ä½•å¿«é€Ÿéƒ¨ç½²å¼€æºæœåŠ¡å™¨"}]